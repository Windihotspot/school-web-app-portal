import{_ as ht,r as a,u as pt,b as vt,o as yt,e as M,f as g,g as ft,w as m,M as xt,h as at,i as lt,j as t,k as b,l as h,m as u,t as o,F as U,n as R,E as A,p as gt,q as bt}from"./index-sDCV2dRb.js";const s=O=>(gt("data-v-b202d009"),O=O(),bt(),O),wt={class:"p-2"},Mt=s(()=>t("h2",{class:"text-xl font-bold mt-2 ml-6"},"Statement Analysis Result",-1)),kt={key:0,class:"flex items-center justify-center h-96"},St={key:1,class:"p-2 md:p-8"},At={class:"flex justify-between"},Ot=s(()=>t("i",{class:"fas fa-arrow-left mr-2"},null,-1)),Ct={class:"text-right"},Dt=s(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),It={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4"},Nt=s(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),Tt=s(()=>t("strong",null,"Statement Period:",-1)),jt=s(()=>t("br",null,null,-1)),Bt=s(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),Et=s(()=>t("strong",null,"Account Name:",-1)),Wt=s(()=>t("br",null,null,-1)),$t=s(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),Ut=s(()=>t("strong",null,"Account Number:",-1)),Rt=s(()=>t("br",null,null,-1)),Vt={class:"mt-6"},Yt={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4"},qt={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Pt={class:"text-md font-semibold"},Lt=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),zt={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Ht={class:"text-md font-semibold"},Gt=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),Jt={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Kt={class:"text-md font-semibold"},Qt=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),Xt={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Zt={class:"text-md font-semibold"},Ft=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),te={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ee={class:"text-md font-semibold"},se=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),oe={class:"flex flex-col md:flex-row gap-4 p-4"},ae={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},le=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense",-1)),ne={class:"font-semibold text-gray-800 leading-tight"},de=s(()=>t("br",null,null,-1)),ie={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},ce=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Highest Spend",-1)),re={class:"font-semibold text-gray-800 text-lg"},ue={class:"text-sm font-semibold text-gray-600 mt-1"},_e={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},me=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense Amount",-1)),he={class:"font-semibold text-gray-800 text-lg"},pe={class:"bg-white p-6 rounded-2xl shadow-md overflow-x-auto"},ve=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 mb-4"},"Expenses",-1)),ye={class:"min-w-full table-auto border-collapse"},fe=s(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-semibold text-gray-600 border-b border-gray-200"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),xe={class:"py-3 px-4"},ge={class:"py-3 px-4"},be={class:"py-3 px-4"},we={class:"flex flex-col md:flex-row gap-4 text-center text-gray-500 py-10"},Me={class:"flex-1 bg-white p-6 rounded-xl shadow"},ke=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Inflow Summary",-1)),Se={class:"space-y-2"},Ae={class:"flex justify-between"},Oe=s(()=>t("span",null,"Total Inflow",-1)),Ce={class:"text-green-600 font-bold"},De={class:"flex justify-between"},Ie=s(()=>t("span",null,"Average Monthly Inflow",-1)),Ne={class:"font-medium"},Te={class:"flex justify-between"},je=s(()=>t("span",null,"Average Weekly Inflow",-1)),Be={class:"font-medium"},Ee={class:"flex-1 bg-white p-6 rounded-xl shadow"},We=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Outflow Summary",-1)),$e={class:"space-y-2"},Ue={class:"flex justify-between"},Re=s(()=>t("span",null,"Total Outflow",-1)),Ve={class:"text-red-600 font-bold"},Ye={class:"flex justify-between"},qe=s(()=>t("span",null,"Average Monthly Outflow",-1)),Pe={class:"font-medium"},Le={class:"flex justify-between"},ze=s(()=>t("span",null,"Average Weekly Outflow",-1)),He={class:"font-medium"},Ge={class:"flex gap-4 justify-between bg-[#f0f8ff] p-6"},Je={class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},Ke={class:"flex-1 text-xl font-semibold"},Qe=s(()=>t("div",{class:"text-sm mt-2"},"Average Monthly Balance",-1)),Xe={class:"flex-1 text-xl font-semibold"},Ze=s(()=>t("div",{class:"text-sm mt-2"},"Average Weekly Balance",-1)),Fe=s(()=>t("div",{class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},[t("div",{class:"flex-1"},[t("div",{class:"text-xl font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate")]),t("div",{class:"flex-1"},[t("div",{class:"text-xl font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow")])],-1)),ts={class:"bg-gray-50 p-6 rounded-lg shadow-md"},es=s(()=>t("h2",{class:"text-xl font-semibold text-gray-800 mb-4"},"Credit & Debit Summary",-1)),ss={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},os={class:"bg-white p-4 rounded-lg shadow"},as=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Monthly Credit & Debit",-1)),ls={class:"overflow-y-auto max-h-96"},ns={class:"min-w-full table-auto text-sm text-left text-gray-600"},ds=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-4 py-2"},"Month"),t("th",{class:"px-4 py-2"},"Total Credit"),t("th",{class:"px-4 py-2"},"Total Debit")])],-1)),is={class:"px-4 py-2"},cs={class:"px-4 py-2"},rs={class:"px-4 py-2"},us={class:"bg-white p-4 rounded-lg shadow"},_s=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Weekly Credit & Debit",-1)),ms={class:"overflow-y-auto max-h-96"},hs={class:"min-w-full table-auto text-sm text-left text-gray-600"},ps=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-4 py-2"},"Week"),t("th",{class:"px-4 py-2"},"Total Credit"),t("th",{class:"px-4 py-2"},"Total Debit")])],-1)),vs={class:"px-4 py-2"},ys={class:"px-4 py-2"},fs={class:"px-4 py-2"},xs=s(()=>t("div",{class:"text-center text-gray-500 py-10"},"Behavioral Content",-1)),gs=s(()=>t("div",{class:"text-center text-gray-500 py-10"},"Transactions Content",-1)),bs={__name:"StatementAnalysis",setup(O){const C=a("Summary");function d(i){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(i||0)}const V=pt(),D=vt(),nt=a(null),I=a(!0),Y=a(null),dt=a(""),q=a(""),B=a(""),P=a(""),L=a(0),z=a(0),E=a(0),W=a(0),$=a(0),H=a(0),G=a(0),it=a(0),J=a(0),K=a(0),ct=a(0),Q=a(0),X=a([]),Z=a([]),F=a(0),tt=a(0),et=a([]),rt=async i=>{var f,w,p,v,l,x,T,j;const r=JSON.parse(localStorage.getItem("data")||"{}"),k=(r==null?void 0:r.token)||D.token,S=`https://dev02201.getjupita.com/api/${((f=r==null?void 0:r.user)==null?void 0:f.tenant_id)||D.tenant_id}/get-analysis-result?analysis_id=${i}`;I.value=!0;try{const _=await at.get(S,{headers:{Authorization:`Bearer ${k}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",_),nt.value=_.data;const n=(v=(p=(w=_.data)==null?void 0:w.data)==null?void 0:p.analysis_result)==null?void 0:v.analysis_result;dt.value=(n==null?void 0:n.name)||"N/A",q.value=(n==null?void 0:n.clientFullName)||"N/A",P.value=(n==null?void 0:n.accountId)||"N/A";const e=n==null?void 0:n.cashFlowAnalysis;F.value=n==null?void 0:n.spendAnalysis.mostFrequentExpense,tt.value=n==null?void 0:n.spendAnalysis.mostFrequentExpenseAmount;const c=((j=(T=(x=(l=_.data)==null?void 0:l.data)==null?void 0:x.analysis_result)==null?void 0:T.analysis_result)==null?void 0:j.spendAnalysis)||{};et.value=[{label:"Others",monthly:c.averageMonthlySpendOnOthers??0,total:12*(c.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:c.averageMonthlySpendOnRent??0,total:12*(c.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:c.averageMonthlySpendOnHospitalityAndFood??0,total:12*(c.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:c.averageMonthlySpendOnTransportation??0,total:12*(c.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:c.averageMonthlySpendOnUtilities??0,total:12*(c.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:c.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(c.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:c.averageMonthlySpendOnTransfer??0,total:12*(c.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:c.averageMonthlySpendOnAtmAndPOS??0,total:12*(c.averageMonthlySpendOnAtmAndPOS??0)}],L.value=(e==null?void 0:e.totalDebitTurnOver)||0,z.value=(e==null?void 0:e.totalCreditTurnover)||0,E.value=(e==null?void 0:e.averageMonthlyDebits)||0,W.value=(e==null?void 0:e.averageMonthlyCredits)||0,$.value=(e==null?void 0:e.averageMonthlyBalance)||0,H.value=(e==null?void 0:e.averageWeeklyBalance)||0,G.value=(e==null?void 0:e.totalCreditTurnover)||0,it.value=(e==null?void 0:e.averageMonthlyCredits)||0,J.value=(e==null?void 0:e.averageWeeklyCredits)||0,K.value=(e==null?void 0:e.totalDebitTurnOver)||0,ct.value=(e==null?void 0:e.averageMonthlyDebits)||0,Q.value=(e==null?void 0:e.averageWeeklyDebits)||0;const _t=(e==null?void 0:e.monthlyInflow)||[];X.value=_t.map(y=>({month:y.month_name+" "+y.year,credit:y.amount,debit:y.amount}));const mt=(e==null?void 0:e.weeklyInflow)||[];Z.value=mt.map(y=>({week:`${y.month_name} ${y.year} Wk ${y.week}`,credit:y.amount,debit:y.amount}));const st=new Date(n==null?void 0:n.createdDate),ot=new Date(n==null?void 0:n.endDate);!isNaN(st)&&!isNaN(ot)?B.value=`${lt(st).format("MMMM D, YYYY")} - ${lt(ot).format("MMMM D, YYYY")}`:B.value="Unknown period"}catch(_){console.error("Error fetching analysis result:",_),Y.value="Unable to fetch analysis result."}finally{I.value=!1}};yt(()=>{const i=V.params.id;i?rt(i):(Y.value="Invalid analysis ID.",I.value=!1)});const ut=async()=>{var w;const i=JSON.parse(localStorage.getItem("data")||"{}"),r=(i==null?void 0:i.token)||D.token,k=((w=i==null?void 0:i.user)==null?void 0:w.tenant_id)||D.tenant_id,N=V.params.id,S=`https://dev02201.getjupita.com/api/${k}/download-insight-report?analysis_id=${N}`;let f=null;try{f=A({message:"Getting your analysis report...",type:"success",duration:0,showClose:!0});const p=await at.get(S,{headers:{Authorization:`Bearer ${r}`}});console.log("download analysis response:",p.data);const v=p.data.data.download;if(!v||!v.document_url||!v.document_name)throw new Error("No download information or document URL found in the response.");A.closeAll();const l=v.document_name||"analysis_report.pdf",T=l.split(".").pop()==="pdf"?l:`${l}.pdf`,j=v.document_url,_=document.createElement("a");_.href=j,_.download=T,_.target="_blank",document.body.appendChild(_),_.click(),document.body.removeChild(_),A({message:"Analysis report downloaded successfully.",type:"success",duration:6e4})}catch(p){console.error("Download failed:",p),A.closeAll(),A.error("Failed to download analysis. Please try again.")}};return(i,r)=>{const k=M("v-progress-circular"),N=M("RouterLink"),S=M("v-btn"),f=M("v-tab"),w=M("v-tabs"),p=M("v-tabs-window-item"),v=M("v-tabs-window");return g(),ft(xt,null,{default:m(()=>[t("div",wt,[Mt,I.value?(g(),b("div",kt,[h(k,{size:100,width:10,color:"primary",indeterminate:""})])):(g(),b("div",St,[t("div",At,[h(N,{to:"/dashboard"},{default:m(()=>[t("button",{onClick:r[0]||(r[0]=(...l)=>i.goBack&&i.goBack(...l)),class:"mb-2 flex items-center text-blue-600 font-semibold"},[Ot,u(" Back ")])]),_:1}),t("div",Ct,[h(S,{onClick:ut,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:m(()=>[Dt,u(" Download Analysis ")]),_:1})])]),t("div",It,[t("p",null,[Nt,Tt,u(),jt,u(" "+o(B.value),1)]),t("p",null,[Bt,Et,u(),Wt,u(" "+o(q.value),1)]),t("p",null,[$t,Ut,u(),Rt,u(" "+o(P.value),1)])]),t("div",Vt,[h(w,{"align-tabs":"center",class:"custom-tabs mb-6",modelValue:C.value,"onUpdate:modelValue":r[1]||(r[1]=l=>C.value=l),color:"primary"},{default:m(()=>[h(f,{value:"summary"},{default:m(()=>[u("Summary")]),_:1}),h(f,{value:"cash flow"},{default:m(()=>[u("Cash Flow")]),_:1}),h(f,{value:"behavioral"},{default:m(()=>[u("Behavioral")]),_:1}),h(f,{value:"transactions"},{default:m(()=>[u("Transactions")]),_:1})]),_:1},8,["modelValue"]),h(v,{modelValue:C.value,"onUpdate:modelValue":r[2]||(r[2]=l=>C.value=l)},{default:m(()=>[h(p,{value:"summary"},{default:m(()=>[t("div",Yt,[t("div",qt,[t("div",Pt,o(d(z.value)),1),Lt]),t("div",zt,[t("div",Ht,o(d(L.value)),1),Gt]),t("div",Jt,[t("div",Kt,o(d(W.value)),1),Qt]),t("div",Xt,[t("div",Zt,o(d(E.value)),1),Ft]),t("div",te,[t("div",ee,o(d($.value)),1),se])]),t("div",oe,[t("div",ae,[le,t("p",ne,[u(o(F.value),1),de])]),t("div",ie,[ce,t("p",re,o(),1),t("p",ue,"Transaction Date: "+o(),1)]),t("div",_e,[me,t("p",he,o(d(tt.value)),1)])]),t("div",pe,[ve,t("table",ye,[fe,t("tbody",null,[(g(!0),b(U,null,R(et.value,(l,x)=>(g(),b("tr",{key:x,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",xe,o(l.label),1),t("td",ge,o(d(l.monthly)),1),t("td",be,o(d(l.total)),1)]))),128))])])])]),_:1}),h(p,{value:"cash flow"},{default:m(()=>[t("div",we,[t("div",Me,[ke,t("div",Se,[t("div",Ae,[Oe,t("span",Ce,o(d(G.value)),1)]),t("div",De,[Ie,t("span",Ne,o(d(W.value)),1)]),t("div",Te,[je,t("span",Be,o(d(J.value)),1)])])]),t("div",Ee,[We,t("div",$e,[t("div",Ue,[Re,t("span",Ve,o(d(K.value)),1)]),t("div",Ye,[qe,t("span",Pe,o(d(E.value)),1)]),t("div",Le,[ze,t("span",He,o(d(Q.value)),1)])])])]),t("div",Ge,[t("div",Je,[t("div",Ke,[u(o(d($.value))+" ",1),Qe]),t("div",Xe,[u(o(d(H.value))+" ",1),Ze])]),Fe]),t("div",ts,[es,t("div",ss,[t("div",os,[as,t("div",ls,[t("table",ns,[ds,t("tbody",null,[(g(!0),b(U,null,R(X.value,(l,x)=>(g(),b("tr",{key:x,class:"border-b"},[t("td",is,o(l.month),1),t("td",cs,o(d(l.credit)),1),t("td",rs,o(d(l.debit)),1)]))),128))])])])]),t("div",us,[_s,t("div",ms,[t("table",hs,[ps,t("tbody",null,[(g(!0),b(U,null,R(Z.value,(l,x)=>(g(),b("tr",{key:x,class:"border-b"},[t("td",vs,o(l.week),1),t("td",ys,o(d(l.credit)),1),t("td",fs,o(d(l.debit)),1)]))),128))])])])])])])]),_:1}),h(p,{value:"behavioral"},{default:m(()=>[xs]),_:1}),h(p,{value:"transactions"},{default:m(()=>[gs]),_:1})]),_:1},8,["modelValue"])])]))])]),_:1})}}},Ms=ht(bs,[["__scopeId","data-v-b202d009"]]);export{Ms as default};
