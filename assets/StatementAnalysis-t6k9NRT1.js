import{b as it,_ as $e,r as s,u as Ce,e as je,f as rt,w as Ue,o as Ve,g as R,h as We,i as w,j as qe,k as v,M as Pe,l as wt,m as A,n as t,p as T,q as h,s as p,t as o,F,v as Z,x as re,y as He,z as Ge,A as ze,E as St,B as Ke,C as Je}from"./index-H2EDhJmn.js";var ue={exports:{}};(function(H,tt){(function(ut,V){V()})(it,function(){function ut(r,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function V(r,u,E){var _=new XMLHttpRequest;_.open("GET",r),_.responseType="blob",_.onload=function(){G(_.response,u,E)},_.onerror=function(){console.error("could not download file")},_.send()}function c(r){var u=new XMLHttpRequest;u.open("HEAD",r,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function W(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(u)}}var S=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof it=="object"&&it.global===it?it:void 0,j=S.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),G=S.saveAs||(typeof window!="object"||window!==S?function(){}:"download"in HTMLAnchorElement.prototype&&!j?function(r,u,E){var _=S.URL||S.webkitURL,x=document.createElement("a");u=u||r.name||"download",x.download=u,x.rel="noopener",typeof r=="string"?(x.href=r,x.origin===location.origin?W(x):c(x.href)?V(r,u,E):W(x,x.target="_blank")):(x.href=_.createObjectURL(r),setTimeout(function(){_.revokeObjectURL(x.href)},4e4),setTimeout(function(){W(x)},0))}:"msSaveOrOpenBlob"in navigator?function(r,u,E){if(u=u||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(ut(r,E),u);else if(c(r))V(r,u,E);else{var _=document.createElement("a");_.href=r,_.target="_blank",setTimeout(function(){W(_)})}}:function(r,u,E,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof r=="string")return V(r,u,E);var x=r.type==="application/octet-stream",_t=/constructor/i.test(S.HTMLElement)||S.safari,et=/CriOS\/[\d]+/.test(navigator.userAgent);if((et||x&&_t||j)&&typeof FileReader<"u"){var z=new FileReader;z.onloadend=function(){var U=z.result;U=et?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=U:location=U,_=null},z.readAsDataURL(r)}else{var K=S.URL||S.webkitURL,q=K.createObjectURL(r);_?_.location=q:location.href=q,_=null,setTimeout(function(){K.revokeObjectURL(q)},4e4)}});S.saveAs=G.saveAs=G,H.exports=G})})(ue);var Xe=ue.exports;const e=H=>(Ke("data-v-9660fa26"),H=H(),Je(),H),Qe={class:"p-2"},Fe={key:0,class:"flex items-center justify-center h-96"},Ze={key:1,class:"p-2 md:p-8"},to=e(()=>t("i",{class:"fas fa-circle-arrow-left mr-2 text-xl",style:{color:"#2563eb"}},null,-1)),eo={class:"flex justify-between rounded shadow-lg p-4 bg-white"},oo=e(()=>t("h2",{class:"text-md font-semibold mt-2 ml-6"},"Analysis result",-1)),so={class:"text-right"},no=e(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),ao={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6 bg-white rounded shadow-lg p-4"},lo=e(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),co=e(()=>t("strong",null,"Statement Period:",-1)),io=e(()=>t("br",null,null,-1)),ro={class:"mt-3"},uo=e(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),_o=e(()=>t("strong",null,"Account Name:",-1)),fo=e(()=>t("br",null,null,-1)),ho=e(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),mo=e(()=>t("strong",null,"Account Number:",-1)),po=e(()=>t("br",null,null,-1)),vo={class:"mt-6"},yo={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4 bg-white rounded shdawo-lg p-4"},bo={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},go={class:"text-md font-semibold"},xo=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),wo={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Mo={class:"text-md font-semibold"},To=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),ko={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Oo={class:"text-md font-semibold"},Ao=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),So={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Yo={class:"text-md font-semibold"},Io=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),Ro={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Do={class:"text-md font-semibold"},No=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),Eo={class:"flex flex-col md:flex-row gap-4 mt-4"},Lo={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},Bo=e(()=>t("p",{class:"text-sm mb-1"},"Most Frequent Expense",-1)),$o={class:"font-semibold text-gray-800 leading-tight"},Co=e(()=>t("br",null,null,-1)),jo={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},Uo={class:"text-sm mb-1"},Vo={class:"font-semibold"},Wo={class:"text-sm mt-1"},qo={class:"font-semibold"},Po={class:"bg-white rounded shadow-md p-4 w-full md:w-1/3"},Ho=e(()=>t("p",{class:"text-sm mb-1"},"Most Frequent Expense Amount",-1)),Go={class:"font-semibold"},zo={class:"bg-white p-6 rounded shadow-md overflow-x-auto mt-4"},Ko=e(()=>t("h2",{class:"text-lg font-semibold m-4"},"Expenses",-1)),Jo={class:"min-w-full table-auto border-collapse"},Xo=e(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-normal border-b border-gray-200 bg-gray-100"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),Qo={class:"py-3 px-4"},Fo={class:"py-3 px-4"},Zo={class:"py-3 px-4"},ts={class:"flex flex-col md:flex-row gap-4 text-gray-500 py-10"},es={class:"flex-1 bg-white border p-6 rounded shadow"},os=e(()=>t("h2",{class:"text-lg font-semibold text-black-800 mb-4"},[p(" Inflow Summary "),t("i",{class:"fas fa-arrow-down text-black-600 ml-2"})],-1)),ss={class:"space-y-4"},ns={class:"mt-6"},as=e(()=>t("p",null,"Total Inflow",-1)),ls={class:"text-green-600 font-bold"},cs={class:"flex justify-between mt-6"},ds={class:""},is=e(()=>t("p",null,"Average Monthly Inflow",-1)),rs={class:"font-medium"},us={class:""},_s=e(()=>t("p",null,"Average Weekly Inflow",-1)),fs={class:"font-medium"},hs={class:"flex-1 bg-white border p-6 rounded shadow"},ms=e(()=>t("h2",{class:"text-lg font-semibold text-black-800 mb-4"},[p(" Outflow Summary "),t("i",{class:"fas fa-arrow-up text-black-600 ml-2"})],-1)),ps={class:"space-y-4"},vs={class:"mt-6"},ys=e(()=>t("p",null,"Total Outflow",-1)),bs={class:"text-red-600 font-bold"},gs={class:"flex justify-between mt-6"},xs={class:""},ws=e(()=>t("p",null,"Average Monthly Outflow",-1)),Ms={class:"font-medium"},Ts={class:""},ks=e(()=>t("p",null,"Average Weekly Outflow",-1)),Os={class:"font-medium"},As={class:"flex gap-4 justify-between p-2"},Ss={class:"flex justify-between bg-[#1f4e99] text-white rounded p-6 w-full"},Ys={class:"flex-1 text-sm"},Is={class:"text-sm mt-2 font-semibold"},Rs={class:"flex-1 text- text-sm"},Ds={class:"text-sm mt-2 font-semibold"},Ns={class:"flex justify-between bg-[#1f4e99] text-white rounded p-6 w-full"},Es={class:"flex-1"},Ls=e(()=>t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate",-1)),Bs={class:"text-md font-semibold"},$s={class:"flex-1"},Cs=e(()=>t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow",-1)),js={class:"text-md font-semibold"},Us={class:"p-2 rounded shadow-md"},Vs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ws={class:"bg-white p-4 rounded shadow"},qs=e(()=>t("h3",{class:"text-lg font-bold mb-6"},"Monthly Credit & Debit",-1)),Ps={class:"overflow-y-auto max-h-96"},Hs={class:"min-w-full table-auto text-sm text-left text-gray-600"},Gs=e(()=>t("thead",{class:"bg-gray-100 font-medium bg-gray-100"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),zs={class:"px-2 py-2"},Ks={class:"px-2 py-2"},Js={class:"px-2 py-2"},Xs={class:"font-semibold text-gray-800 bg-gray-50 border-t"},Qs=e(()=>t("td",{class:"px-2 py-2"},"Total",-1)),Fs={class:"px-2 text-green-800 py-2"},Zs={class:"px-2 text-red-800 py-2"},tn={class:"bg-white p-4 rounded-lg shadow"},en=e(()=>t("h3",{class:"text-lg font-bold mb-6"},"Weekly Credit & Debit",-1)),on={class:"overflow-y-auto max-h-96"},sn={class:"min-w-full table-auto text-sm text-left text-gray-600"},nn=e(()=>t("thead",{class:"bg-gray-100 font-medium"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),an={class:"px-2 py-2"},ln={class:"px-2 py-2"},cn={class:"px-2 py-2"},dn={class:"font-semibold text-gray-800 bg-gray-50 border-t"},rn=e(()=>t("td",{class:"px-2 py-2"},"Total",-1)),un={class:"px-2 text-green-800 py-2"},_n={class:"px-2 text-red-800 py-2"},fn={class:""},hn={class:"bg-white p-6 rounded shadow-md mb-6"},mn=e(()=>t("h2",{class:"text-lg font-semibold mb-6 flex items-center gap-2"},[p(" Loan Analysis "),t("i",{class:"fas fa-info-circle text-blue-700 text-base"})],-1)),pn={class:"grid grid-cols-1 md:grid-cols-4 gap-6 text-sm"},vn=e(()=>t("p",{class:"text-gray-600"},"Number of Loan Transactions",-1)),yn={class:"font-bold text-black"},bn=e(()=>t("p",{class:"text-gray-600"},"Total Loan Amount",-1)),gn={class:"text-red-600 font-bold"},xn=e(()=>t("p",{class:"text-gray-600"},"Average Monthly Loan Amount",-1)),wn={class:"text-blue-700 font-bold"},Mn=e(()=>t("p",{class:"text-gray-600"},"Total Loan Repayment Amount",-1)),Tn={class:"text-green-600 font-bold"},kn=e(()=>t("p",{class:"text-gray-600"},"Avg. Monthly Loan Repayment Amt",-1)),On={class:"text-black font-bold"},An=e(()=>t("p",{class:"text-gray-600"},"Loan to Inflow Rate",-1)),Sn={class:"text-black font-bold"},Yn=e(()=>t("p",{class:"text-gray-600"},"Latest Loan Transaction Date",-1)),In={class:"text-black font-bold"},Rn=e(()=>t("p",{class:"text-gray-600"},"Latest Loan Repayment Transaction Date",-1)),Dn={class:"text-black font-bold"},Nn={class:"bg-blue-700 p-6 rounded shadow-md mb-6"},En=e(()=>t("h2",{class:"text-lg font-semibold text-white mb-6 flex items-center gap-2"},[p(" Patterns "),t("i",{class:"fas fa-chart-line text-white text-xs"})],-1)),Ln={class:"grid grid-cols-1 md:grid-cols-4 gap-6 text-sm text-white"},Bn=e(()=>t("p",null,"Account Sweep",-1)),$n=e(()=>t("p",null,"Number of Betting Transactions",-1)),Cn={class:"font-bold"},jn=e(()=>t("p",null,"Gambling Rate",-1)),Un={class:"font-bold"},Vn=e(()=>t("p",null,"Transactions between 500k - 1M",-1)),Wn={class:"font-bold"},qn=e(()=>t("p",null,"Percentage of Credit Transactions",-1)),Pn={class:"font-bold"},Hn=e(()=>t("p",null,"Percentage of Debit Transactions",-1)),Gn={class:"font-bold"},zn=e(()=>t("p",null,"Most Frequent",-1)),Kn={class:"font-bold"},Jn=e(()=>t("p",null,"Transactions Greater than 1M",-1)),Xn={class:"font-bold"},Qn={class:"bg-white p-6 rounded-lg shadow text-sm text-gray-800"},Fn=e(()=>t("h2",{class:"text-base font-semibold mb-4"},"Self Transfer Summary",-1)),Zn={class:"grid grid-cols-3 gap-4 mb-6"},ta=e(()=>t("div",null,"Number of Self Transfer (Inflow)",-1)),ea={class:"font-bold mt-1"},oa=e(()=>t("div",null,"Value of Self Transfer (Inflow)",-1)),sa={class:"text-green-600 font-bold mt-1"},na=e(()=>t("div",null,"Total Number of Transactions",-1)),aa={class:"font-bold mt-1"},la=e(()=>t("div",null,"Number of Self Transfer (Outflow)",-1)),ca={class:"font-bold mt-1"},da=e(()=>t("div",null,"Value of Self Transfer (Outflow)",-1)),ia={class:"text-red-600 font-bold mt-1"},ra=e(()=>t("div",null,"Returned Cheque",-1)),ua={class:"font-bold mt-1"},_a={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},fa={class:"w-full md:w-1/2"},ha={class:"bg-white rounded border shadow p-4 max-h-96 overflow-y-auto"},ma=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-4"}," Self Transfer Transactions ",-1)),pa={class:"w-full text-sm text-left"},va=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),ya={key:0},ba=e(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),ga=[ba],xa={class:"py-2 px-4"},wa={class:"py-2 px-4"},Ma={class:"py-2 px-4"},Ta={class:"w-full md:w-1/2"},ka={class:"bg-white border rounded shadow p-4 max-h-96 overflow-y-auto"},Oa=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-4"}," Account Balance Analysis ",-1)),Aa={class:"w-full text-sm text-left"},Sa=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),Ya={class:"py-2 px-4"},Ia={class:"py-2 px-4"},Ra={class:"py-2 px-4"},Da={class:"py-4"},Na=e(()=>t("span",{class:"text-md font-semibold mt-6 ml-2"},"Transaction History",-1)),Ea={class:"flex items-center justify-between p-2"},La={class:"flex items-center space-x-4 pt-2"},Ba=e(()=>t("i",{class:"fa-solid fa-filter"},null,-1)),$a=e(()=>t("i",{class:"fas fa-search text-gray-500"},null,-1)),Ca={class:"relative min-h-[200px]"},ja=e(()=>t("thead",{class:"font-semibold bg-gray-100"},[t("tr",null,[t("th",{class:"px-2 py-3 font-semibold"},"S/N"),t("th",{class:"px-2 py-3 font-semibold"},"Date"),t("th",{class:"px-2 py-3 font-semibold"},"Description"),t("th",{class:"px-2 py-3 font-semibold"},"Type"),t("th",{class:"px-2 py-3 font-semibold"},"Amount"),t("th",{class:"px-2 py-3 font-semibold"},"Balance")])],-1)),Ua={class:"px-2 py-4"},Va={class:"px-2 py-4"},Wa={class:"px-2 py-4"},qa={class:"px-6 py-4 font-semibold"},Pa={class:"px-2 py-4"},Ha={class:"px-2 py-4"},Ga=e(()=>t("span",null,"1â€“12 of 12",-1)),za={class:"flex items-center space-x-2"},Ka=e(()=>t("span",null,"Rows per page:",-1)),Ja={__name:"StatementAnalysis",setup(H){const tt=s("Summary"),ut=d=>A(d).format("MMMM Do YYYY,");function V(d){return typeof d!="number"?"0%":`${(d*100).toFixed(2)}%`}function c(d){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(d||0)}const W=s(15),S=Ce(),j=je(),G=s(null),r=s(!0),u=s(null),E=s(""),_=s(""),x=s(""),_t=s(""),et=s(0),z=s(0),K=s(0),q=s(0),U=s(0),Yt=s(0),Mt=s(0),_e=s(0),It=s(0),ot=s(0),fe=s(0),Rt=s(0),ft=s([]),ht=s([]),he=rt(()=>ft.value.reduce((d,i)=>d+i.credit,0)),me=rt(()=>ft.value.reduce((d,i)=>d+i.debit,0)),pe=rt(()=>ht.value.reduce((d,i)=>d+i.credit,0)),ve=rt(()=>ht.value.reduce((d,i)=>d+i.debit,0)),Dt=s(0),Nt=s(0),Et=s(0),Lt=s(""),Bt=s([]),$t=s(""),Ct=s(""),jt=s(""),Ut=s(""),Vt=s(0),Tt=s(""),Wt=s(0),qt=s(""),ye=s(0),be=s(0),Pt=s(0),Ht=s(0),Gt=s(0),zt=s(0),Kt=s(0),ge=s(0),xe=s(0),Jt=s(""),Xt=s([]),Qt=s(""),we=s(""),Me=s(0),Te=s(""),Ft=s(0),Zt=s(0),te=s(0),ee=s(0),oe=s(0),kt=s(0),se=s(0),ne=s(0),mt=s([]),ae=s([]),Ot=s([]),pt=s([]),ke=async d=>{var M,D,O,B,L,X,nt,P,Q,yt,bt,gt,l;const i=JSON.parse(localStorage.getItem("data")||"{}"),C=(i==null?void 0:i.token)||j.token,k=`https://dev02201.getjupita.com/api/${((M=i==null?void 0:i.user)==null?void 0:M.tenant_id)||j.tenant_id}/get-analysis-result?analysis_id=${d}`;r.value=!0;try{let ce=function(a){return A(a,"M-YYYY").format("MMM YYYY")};const y=await wt.get(k,{headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",y),G.value=y.data;const f=(B=(O=(D=y.data)==null?void 0:D.data)==null?void 0:O.analysis_result)==null?void 0:B.analysis_result;E.value=(f==null?void 0:f.name)||"N/A",_.value=(f==null?void 0:f.clientFullName)||"N/A",_t.value=(f==null?void 0:f.accountId)||"N/A";const b=(f==null?void 0:f.behavioralAnalysis)||{};console.log("behavioural:",b),Tt.value=b.accountSweep||"No",Wt.value=b.gamblingRate||0,qt.value=b.gamblingStatus||"N/A",ye.value=b.loanInflowRate||0,be.value=b.accountActivity||0,Pt.value=b.totalLoanAmount||0,Ht.value=b.loanToInflowRate||0,Gt.value=b.numberLoanTransactions||0,zt.value=b.averageMonthlyLoanAmount||0,Kt.value=b.totalLoanRepaymentAmount||0,ge.value=b.loanRepaymentToInflowRate||0,xe.value=b.numberRepaymentTransactions||0,Xt.value=b.latestRepaymentTransaction||[];const xt=Xt.value[0]||null;Qt.value=xt!=null&&xt.date?A(xt.date).format("MMM D, YYYY"):"N/A";const le=(L=b.latestLoanTransaction)==null?void 0:L[0];Jt.value=le?A(le.date).format("MMMM D, YYYY"):"N/A",we.value=b.overallInflowToOutflowRate||"N/A",Me.value=b.percentOfInflowIrregularity||0,Te.value=b.monthToMonthInflowToOutflowRate||"N/A",Ft.value=b.averageMonthlyLoanRepaymentAmount||0;const n=f==null?void 0:f.cashFlowAnalysis;console.log("cash flow data:",n),Dt.value=f==null?void 0:f.spendAnalysis.mostFrequentExpense,Nt.value=f==null?void 0:f.spendAnalysis.mostFrequentExpenseAmount;const g=((Q=(P=(nt=(X=y.data)==null?void 0:X.data)==null?void 0:nt.analysis_result)==null?void 0:P.analysis_result)==null?void 0:Q.spendAnalysis)||{},I=((l=(gt=(bt=(yt=y.data)==null?void 0:yt.data)==null?void 0:bt.analysis_result)==null?void 0:gt.analysis_result)==null?void 0:l.transactionPatternAnalysis)||{};console.log("pattern analysis:",I),$t.value=(I.percentDebitTransactions*100).toFixed(2)+"%",Ct.value=(I.percentCreditTransactions*100).toFixed(2)+"%",jt.value=(I.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",Ut.value=(I.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",Vt.value=I.mostFrequentBalanceRange,Zt.value=I.noOfSelfTransferInflows,te.value=I.noOfSelfTransferOutflows,ee.value=I.selfTransferInflowAmount,oe.value=I.selfTransferOutflowAmount,se.value=I.totalNumberOfTransactions,ne.value=I.returnCheque;const Ye=I.selfTransferInflowTransactionsByMonth||[],Ie=I.selfTransferOutflowTransactionsByMonth||[],at=new Map;Ye.forEach(a=>{const m=ce(a.date);at.set(m,{month:m,inflow:a.amount,outflow:0})}),Ie.forEach(a=>{const m=ce(a.date);at.has(m)?at.get(m).outflow=a.amount:at.set(m,{month:m,inflow:0,outflow:a.amount})}),mt.value=Array.from(at.values()).sort((a,m)=>A(a.month,"MMM YYYY")-A(m.month,"MMM YYYY")),Et.value=g.highestSpend,Lt.value=A(g.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Bt.value=[{label:"Others",monthly:g.averageMonthlySpendOnOthers??0,total:12*(g.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:g.averageMonthlySpendOnRent??0,total:12*(g.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:g.averageMonthlySpendOnHospitalityAndFood??0,total:12*(g.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:g.averageMonthlySpendOnTransportation??0,total:12*(g.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:g.averageMonthlySpendOnUtilities??0,total:12*(g.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:g.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(g.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:g.averageMonthlySpendOnTransfer??0,total:12*(g.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:g.averageMonthlySpendOnAtmAndPOS??0,total:12*(g.averageMonthlySpendOnAtmAndPOS??0)}],et.value=(n==null?void 0:n.totalDebitTurnOver)||0,z.value=(n==null?void 0:n.totalCreditTurnover)||0,K.value=(n==null?void 0:n.averageMonthlyDebits)||0,q.value=(n==null?void 0:n.averageMonthlyCredits)||0,U.value=(n==null?void 0:n.averageMonthlyBalance)||0,Yt.value=(n==null?void 0:n.averageWeeklyBalance)||0,Mt.value=(n==null?void 0:n.totalCreditTurnover)||0,_e.value=(n==null?void 0:n.averageMonthlyCredits)||0,It.value=(n==null?void 0:n.averageWeeklyCredits)||0,ot.value=(n==null?void 0:n.totalDebitTurnOver)||0,fe.value=(n==null?void 0:n.averageMonthlyDebits)||0,Rt.value=(n==null?void 0:n.averageWeeklyDebits)||0;const Re=(n==null?void 0:n.monthlyHighestBalance)||[],De=(n==null?void 0:n.monthlyLowestBalance)||[];kt.value=ot.value!==0?+((Mt.value-ot.value)/ot.value*100).toFixed(2):0;const lt=new Map;Re.forEach(a=>{const m=`${a.month_name} ${a.year}`,N=A(m,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;lt.set($,{month:N,highest:a.highest_balance,lowest:0})}),De.forEach(a=>{const m=`${a.month_name} ${a.year}`,N=A(m,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;lt.has($)?lt.get($).lowest=a.lowest_balance:lt.set($,{month:N,highest:0,lowest:a.lowest_balance})}),ae.value=Array.from(lt.values());const Ne=(n==null?void 0:n.monthlyInflow)||[],Ee=(n==null?void 0:n.monthlyOutflow)||[],ct=new Map;Ne.forEach(a=>{const m=`${a.month_name} ${a.year}`,N=A(m,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;ct.set($,{month:N,credit:a.amount,debit:0})}),Ee.forEach(a=>{const m=`${a.month_name} ${a.year}`,N=A(m,"MMMM YYYY").format("MMM YYYY"),$=`${a.month_name}-${a.year}`;ct.has($)?ct.get($).debit=a.amount:ct.set($,{month:N,credit:0,debit:a.amount})}),ft.value=Array.from(ct.values());const Le=(n==null?void 0:n.weeklyInflow)||[],Be=(n==null?void 0:n.weeklyOutflow)||[],dt=new Map;Le.forEach(a=>{const m=A().month(a.month_name).format("MMM"),N=`${a.year}-${m}-W${a.week}`;dt.set(N,{week:`${m} ${a.year} | ${a.week}`,credit:a.amount,debit:0})}),Be.forEach(a=>{const m=A().month(a.month_name).format("MMM"),N=`${a.year}-${m}-W${a.week}`;dt.has(N)?dt.get(N).debit=a.amount:dt.set(N,{week:`${m} ${a.year} ${a.week}`,credit:0,debit:a.amount})}),ht.value=Array.from(dt.values());const de=new Date(f==null?void 0:f.startDate),ie=new Date(f==null?void 0:f.endDate);!isNaN(de)&&!isNaN(ie)?x.value=`${A(de).format("MMMM D, YYYY")} - ${A(ie).format("MMMM D, YYYY")}`:x.value="Unknown period"}catch(y){console.error("Error fetching analysis result:",y),u.value="Unable to fetch analysis result."}finally{r.value=!1}},Oe=rt(()=>{const d=kt.value;return d>0?"Positive cash flow":d<0?"Negative cash flow":"neutral"}),Ae=async d=>{var D;const i=JSON.parse(localStorage.getItem("data")||"{}"),C=(i==null?void 0:i.token)||j.token,Y=((D=i==null?void 0:i.user)==null?void 0:D.tenant_id)||j.tenant_id,k=S.params.id,M=`https://dev02201.getjupita.com/api/${Y}/get-statement-transactions?analysis_id=${k}`;try{const O=await wt.get(M,{headers:{Authorization:`Bearer ${C}`}});console.log("fetch transactions response:",O),pt.value=O.data.data.transactions,Ot.value=[...pt.value]}catch(O){console.error(O)}},vt=s(""),st=s(null),J=s([]),At=s(!1);Ue([vt,st,J,pt],async()=>{var C;At.value=!0,await ze();let d=pt.value;const i=(C=vt.value)==null?void 0:C.toLowerCase().trim();if(i&&(d=d.filter(Y=>Object.values(Y).some(k=>k==null?void 0:k.toString().toLowerCase().includes(i)))),st.value&&(d=d.filter(Y=>Y.type===st.value)),J.value&&J.value.length===2){const[Y,k]=J.value.map(M=>new Date(M).getTime());d=d.filter(M=>{const D=new Date(M.date).getTime();return D>=Y&&D<=k})}Ot.value=d,await new Promise(Y=>setTimeout(Y,300)),At.value=!1}),Ve(()=>{const d=S.params.id;d?(ke(d),Ae()):(u.value="Invalid analysis ID.",r.value=!1)});const Se=async()=>{var M,D,O;const d=JSON.parse(localStorage.getItem("data")||"{}"),i=(d==null?void 0:d.token)||j.token,C=((M=d==null?void 0:d.user)==null?void 0:M.tenant_id)||j.tenant_id,Y=S.params.id,k=`https://dev02201.getjupita.com/api/${C}/download-insight-report?analysis_id=${Y}`;try{St({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const B=await wt.get(k,{headers:{Authorization:`Bearer ${i}`}}),L=(O=(D=B==null?void 0:B.data)==null?void 0:D.data)==null?void 0:O.download;if(!(L!=null&&L.document_url)||!(L!=null&&L.document_name))throw new Error("No download information or document URL found in the response.");const X=L.document_url,P="analysis_report.pdf",Q=await wt.get(X,{responseType:"blob"});Xe.saveAs(Q.data,P),St({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(B){console.error("Download failed:",B),St({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(d,i)=>{const C=R("v-progress-circular"),Y=R("RouterLink"),k=R("v-btn"),M=R("v-tab"),D=R("v-tabs"),O=R("v-tabs-window-item"),B=R("v-select"),L=R("v-text-field"),X=R("el-date-picker"),nt=R("v-table"),P=R("v-icon"),Q=R("v-card-actions"),yt=R("v-card"),bt=R("v-tabs-window"),gt=We("loading");return w(),qe(Pe,null,{default:v(()=>[t("div",Qe,[r.value?(w(),T("div",Fe,[h(C,{size:100,width:10,color:"primary",indeterminate:""})])):(w(),T("div",Ze,[h(Y,{to:"/dashboard"},{default:v(()=>[t("button",{onClick:i[0]||(i[0]=(...l)=>d.goBack&&d.goBack(...l)),class:"mb-4 flex items-center text-black text-lg font-normal"},[to,p(" Back ")])]),_:1}),t("div",eo,[oo,t("div",so,[h(k,{onClick:Se,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:v(()=>[no,p(" Export PDF ")]),_:1})])]),t("div",ao,[t("p",null,[lo,co,p(),io,t("span",ro,o(x.value),1)]),t("p",null,[uo,_o,p(),fo,p(" "+o(_.value),1)]),t("p",null,[ho,mo,p(),po,p(" "+o(_t.value),1)])]),t("div",vo,[h(D,{modelValue:tt.value,"onUpdate:modelValue":i[1]||(i[1]=l=>tt.value=l),"align-tabs":"start",class:"custom-tabs mb-4",color:"primary",grow:""},{default:v(()=>[h(M,{value:"summary"},{default:v(()=>[p("Summary")]),_:1}),h(M,{value:"cash flow"},{default:v(()=>[p("Cash Flow")]),_:1}),h(M,{value:"behavioral"},{default:v(()=>[p("Behavioral")]),_:1}),h(M,{value:"transactions"},{default:v(()=>[p("Transactions")]),_:1})]),_:1},8,["modelValue"]),h(bt,{modelValue:tt.value,"onUpdate:modelValue":i[6]||(i[6]=l=>tt.value=l)},{default:v(()=>[h(O,{value:"summary"},{default:v(()=>[t("div",yo,[t("div",bo,[t("div",go,o(c(z.value)),1),xo]),t("div",wo,[t("div",Mo,o(c(et.value)),1),To]),t("div",ko,[t("div",Oo,o(c(q.value)),1),Ao]),t("div",So,[t("div",Yo,o(c(K.value)),1),Io]),t("div",Ro,[t("div",Do,o(c(U.value)),1),No])]),t("div",Eo,[t("div",Lo,[Bo,t("p",$o,[p(o(Dt.value),1),Co])]),t("div",jo,[t("p",Uo,[p(" Highest Spend: "),t("span",Vo,o(c(Et.value)),1)]),t("p",Wo,[p(" Transaction Date: "),t("span",qo,o(Lt.value),1)])]),t("div",Po,[Ho,t("p",Go,o(c(Nt.value)),1)])]),t("div",zo,[Ko,t("table",Jo,[Xo,t("tbody",null,[(w(!0),T(F,null,Z(Bt.value,(l,y)=>(w(),T("tr",{key:y,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",Qo,o(l.label),1),t("td",Fo,o(c(l.monthly)),1),t("td",Zo,o(c(l.total)),1)]))),128))])])])]),_:1}),h(O,{value:"cash flow"},{default:v(()=>[t("div",ts,[t("div",es,[os,t("div",ss,[t("div",ns,[as,t("span",ls,o(c(Mt.value)),1)]),t("div",cs,[t("div",ds,[is,t("span",rs,o(c(q.value)),1)]),t("div",us,[_s,t("span",fs,o(c(It.value)),1)])])])]),t("div",hs,[ms,t("div",ps,[t("div",vs,[ys,t("span",bs,o(c(ot.value)),1)]),t("div",gs,[t("div",xs,[ws,t("span",Ms,o(c(K.value)),1)]),t("div",Ts,[ks,t("span",Os,o(c(Rt.value)),1)])])])])]),t("div",As,[t("div",Ss,[t("div",Ys,[p(" Average Monthly Balance "),t("div",Is,o(c(U.value)),1)]),t("div",Rs,[p(" Average Weekly Balance "),t("div",Ds,o(c(Yt.value)),1)])]),t("div",Ns,[t("div",Es,[Ls,t("div",Bs,o(Oe.value),1)]),t("div",$s,[Cs,t("div",js,o(V(kt.value)),1)])])]),t("div",Us,[t("div",Vs,[t("div",Ws,[qs,t("div",Ps,[t("table",Hs,[Gs,t("tbody",null,[(w(!0),T(F,null,Z(ft.value,(l,y)=>(w(),T("tr",{key:y,class:"border-b"},[t("td",zs,o(l.month),1),t("td",Ks,o(c(l.credit)),1),t("td",Js,o(c(l.debit)),1)]))),128))]),t("tfoot",Xs,[t("tr",null,[Qs,t("td",Fs,o(c(he.value)),1),t("td",Zs,o(c(me.value)),1)])])])])]),t("div",tn,[en,t("div",on,[t("table",sn,[nn,t("tbody",null,[(w(!0),T(F,null,Z(ht.value,(l,y)=>(w(),T("tr",{key:y,class:"border-b"},[t("td",an,o(l.week),1),t("td",ln,o(c(l.credit)),1),t("td",cn,o(c(l.debit)),1)]))),128))]),t("tfoot",dn,[t("tr",null,[rn,t("td",un,o(c(pe.value)),1),t("td",_n,o(c(ve.value)),1)])])])])])])])]),_:1}),h(O,{value:"behavioral"},{default:v(()=>[t("div",fn,[t("div",hn,[mn,t("div",pn,[t("div",null,[vn,t("p",yn,o(Gt.value),1)]),t("div",null,[bn,t("p",gn,o(c(Pt.value)),1)]),t("div",null,[xn,t("p",wn,o(c(zt.value)),1)]),t("div",null,[Mn,t("p",Tn,o(c(Kt.value)),1)]),t("div",null,[kn,t("p",On,o(c(Ft.value)),1)]),t("div",null,[An,t("p",Sn,o(c(Ht.value)),1)]),t("div",null,[Yn,t("p",In,o(Jt.value),1)]),t("div",null,[Rn,t("p",Dn,o(Qt.value),1)])])]),t("div",Nn,[En,t("div",Ln,[t("div",null,[Bn,t("p",{class:re(Tt.value==="YES"?"font-bold text-white":"text-gray-300")},o(Tt.value),3)]),t("div",null,[$n,t("p",Cn,o(qt.value),1)]),t("div",null,[jn,t("p",Un,o(Wt.value),1)]),t("div",null,[Vn,t("p",Wn,o(jt.value),1)]),t("div",null,[qn,t("p",Pn,o(Ct.value),1)]),t("div",null,[Hn,t("p",Gn,o($t.value),1)]),t("div",null,[zn,t("p",Kn,o(Vt.value),1)]),t("div",null,[Jn,t("p",Xn,o(Ut.value),1)])])])]),t("div",Qn,[Fn,t("div",Zn,[t("div",null,[ta,t("div",ea,o(Zt.value),1)]),t("div",null,[oa,t("div",sa,o(c(ee.value)),1)]),t("div",null,[na,t("div",aa,o(se.value),1)]),t("div",null,[la,t("div",ca,o(te.value),1)]),t("div",null,[da,t("div",ia,o(c(oe.value)),1)]),t("div",null,[ra,t("div",ua,o(c(ne.value)),1)])])]),t("div",_a,[t("div",fa,[t("div",ha,[ma,t("table",pa,[va,t("tbody",null,[!mt.value||mt.value.length===0?(w(),T("tr",ya,ga)):He("",!0),(w(!0),T(F,null,Z(mt.value,(l,y)=>(w(),T("tr",{key:y,class:"border-b last:border-none"},[t("td",xa,o(l.month),1),t("td",wa,o(c(l.inflow)),1),t("td",Ma,o(c(l.outflow)),1)]))),128))])])])]),t("div",Ta,[t("div",ka,[Oa,t("table",Aa,[Sa,t("tbody",null,[(w(!0),T(F,null,Z(ae.value,(l,y)=>(w(),T("tr",{key:y},[t("td",Ya,o(l.month),1),t("td",Ia,o(c(l.highest)),1),t("td",Ra,o(c(l.lowest)),1)]))),128))])])])])])]),_:1}),h(O,{value:"transactions"},{default:v(()=>[t("div",Da,[h(yt,{class:"rounded-lg shadow-md pa-4"},{default:v(()=>[Na,t("div",Ea,[t("div",La,[Ba,h(B,{modelValue:st.value,"onUpdate:modelValue":i[2]||(i[2]=l=>st.value=l),items:["CREDIT","DEBIT"],color:"blue",label:"Status",density:"compact","hide-details":"",variant:"outlined",class:"w-32"},null,8,["modelValue"])]),h(L,{modelValue:vt.value,"onUpdate:modelValue":i[3]||(i[3]=l=>vt.value=l),rounded:"",placeholder:"Search for a transaction",density:"compact","hide-details":"",variant:"outlined",class:"max-w-xs rounded-md",label:"Search",color:"blue","append-inner-icon":""},{"append-inner":v(()=>[$a]),_:1},8,["modelValue"])]),h(X,{modelValue:J.value,"onUpdate:modelValue":i[4]||(i[4]=l=>J.value=l),type:"daterange","range-separator":"to","start-placeholder":"Start date","end-placeholder":"End date",class:"w-20 m-2",size:"small"},null,8,["modelValue"]),Ge((w(),T("div",Ca,[h(nt,{class:"min-w-full text-sm pa-2"},{default:v(()=>[ja,t("tbody",null,[(w(!0),T(F,null,Z(Ot.value,(l,y)=>(w(),T("tr",{key:y,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",Ua,o(y+1),1),t("td",Va,o(ut(l.date)),1),t("td",Wa,o(l.description),1),t("td",qa,[t("span",{class:re(l.type==="CREDIT"?"text-green-600 py-1 px-2 text-xs font-semibold rounded-full bg-green-100":"text-red-600 py-1 px-2 text-xs font-semibold rounded-full bg-red-100")},o(l.type),3)]),t("td",Pa,o(c(l.amount)),1),t("td",Ha,o(c(l.balance)),1)]))),128))])]),_:1})])),[[gt,At.value]]),h(Q,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:v(()=>[Ga,t("div",za,[Ka,h(B,{items:[15,30,45],modelValue:W.value,"onUpdate:modelValue":i[5]||(i[5]=l=>W.value=l),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),h(k,{icon:"",density:"comfortable"},{default:v(()=>[h(P,null,{default:v(()=>[p("mdi-chevron-left")]),_:1})]),_:1}),h(k,{icon:"",density:"comfortable"},{default:v(()=>[h(P,null,{default:v(()=>[p("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])])]))])]),_:1})}}},Qa=$e(Ja,[["__scopeId","data-v-9660fa26"]]);export{Qa as default};
