import{b as at,_ as Ee,r as o,e as Le,f as re,u as $e,g as Be,o as Ce,h as b,i as w,j as Ve,w as m,M as Ue,k as mt,l as A,m as t,n as O,p as c,q as y,t as n,F as X,s as Q,v as ue,x as We,y as _e,E as gt,z as qe,A as Pe}from"./index-CJaPtZm4.js";var me={exports:{}};(function(q,lt){(function(P,p){p()})(at,function(){function P(r,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function p(r,a,Y){var _=new XMLHttpRequest;_.open("GET",r),_.responseType="blob",_.onload=function(){L(_.response,a,Y)},_.onerror=function(){console.error("could not download file")},_.send()}function dt(r){var a=new XMLHttpRequest;a.open("HEAD",r,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function H(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(a)}}var g=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof at=="object"&&at.global===at?at:void 0,it=g.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),L=g.saveAs||(typeof window!="object"||window!==g?function(){}:"download"in HTMLAnchorElement.prototype&&!it?function(r,a,Y){var _=g.URL||g.webkitURL,h=document.createElement("a");a=a||r.name||"download",h.download=a,h.rel="noopener",typeof r=="string"?(h.href=r,h.origin===location.origin?H(h):dt(h.href)?p(r,a,Y):H(h,h.target="_blank")):(h.href=_.createObjectURL(r),setTimeout(function(){_.revokeObjectURL(h.href)},4e4),setTimeout(function(){H(h)},0))}:"msSaveOrOpenBlob"in navigator?function(r,a,Y){if(a=a||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(P(r,Y),a);else if(dt(r))p(r,a,Y);else{var _=document.createElement("a");_.href=r,_.target="_blank",setTimeout(function(){H(_)})}}:function(r,a,Y,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof r=="string")return p(r,a,Y);var h=r.type==="application/octet-stream",ft=/constructor/i.test(g.HTMLElement)||g.safari,U=/CriOS\/[\d]+/.test(navigator.userAgent);if((U||h&&ft||it)&&typeof FileReader<"u"){var G=new FileReader;G.onloadend=function(){var $=G.result;$=U?$:$.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=$:location=$,_=null},G.readAsDataURL(r)}else{var ct=g.URL||g.webkitURL,z=ct.createObjectURL(r);_?_.location=z:location.href=z,_=null,setTimeout(function(){ct.revokeObjectURL(z)},4e4)}});g.saveAs=L.saveAs=L,q.exports=L})})(me);var He=me.exports;const s=q=>(qe("data-v-4cf84915"),q=q(),Pe(),q),Ge={class:"p-2"},ze=s(()=>t("h2",{class:"text-xl font-bold mt-2 ml-6"},"Statement Analysis Result",-1)),Fe={key:0,class:"flex items-center justify-center h-96"},Ke={key:1,class:"p-2 md:p-8"},Je={class:"flex justify-between"},Xe=s(()=>t("i",{class:"fas fa-arrow-left mr-2"},null,-1)),Qe={class:"text-right"},Ze=s(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),ts={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6"},es=s(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),ss=s(()=>t("strong",null,"Statement Period:",-1)),os=s(()=>t("br",null,null,-1)),ns=s(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),as=s(()=>t("strong",null,"Account Name:",-1)),ls=s(()=>t("br",null,null,-1)),ds=s(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),is=s(()=>t("strong",null,"Account Number:",-1)),cs=s(()=>t("br",null,null,-1)),rs={class:"mt-6"},us={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4"},_s={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ms={class:"text-md font-semibold"},fs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),ps={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},vs={class:"text-md font-semibold"},hs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),ys={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},xs={class:"text-md font-semibold"},bs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),gs={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ws={class:"text-md font-semibold"},Ms=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),Ts={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},As={class:"text-md font-semibold"},Os=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),ks={class:"flex flex-col md:flex-row gap-4 p-4"},Ys={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Ss=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense",-1)),Rs={class:"font-semibold text-gray-800 leading-tight"},Ds=s(()=>t("br",null,null,-1)),Is={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},js=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Highest Spend",-1)),Ns={class:"font-semibold text-gray-800 text-lg"},Es={class:"text-sm font-semibold text-gray-600 mt-1"},Ls={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},$s=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense Amount",-1)),Bs={class:"font-semibold text-gray-800 text-lg"},Cs={class:"bg-white p-6 rounded-2xl shadow-md overflow-x-auto"},Vs=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 m-4"},"Expenses",-1)),Us={class:"min-w-full table-auto border-collapse"},Ws=s(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-semibold text-gray-600 border-b border-gray-200"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),qs={class:"py-3 px-4"},Ps={class:"py-3 px-4"},Hs={class:"py-3 px-4"},Gs={class:"flex flex-col md:flex-row gap-4 text-center text-gray-500 py-10"},zs={class:"flex-1 bg-white border p-6 rounded-xl shadow"},Fs=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Inflow Summary",-1)),Ks={class:"space-y-2"},Js={class:"flex justify-between"},Xs=s(()=>t("span",null,"Total Inflow",-1)),Qs={class:"text-green-600 font-bold"},Zs={class:"flex justify-between"},to=s(()=>t("span",null,"Average Monthly Inflow",-1)),eo={class:"font-medium"},so={class:"flex justify-between"},oo=s(()=>t("span",null,"Average Weekly Inflow",-1)),no={class:"font-medium"},ao={class:"flex-1 bg-white border p-6 rounded-xl shadow"},lo=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Outflow Summary",-1)),io={class:"space-y-2"},co={class:"flex justify-between"},ro=s(()=>t("span",null,"Total Outflow",-1)),uo={class:"text-red-600 font-bold"},_o={class:"flex justify-between"},mo=s(()=>t("span",null,"Average Monthly Outflow",-1)),fo={class:"font-medium"},po={class:"flex justify-between"},vo=s(()=>t("span",null,"Average Weekly Outflow",-1)),ho={class:"font-medium"},yo={class:"flex gap-4 justify-between p-2"},xo={class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},bo={class:"flex-1 text-md font-semibold"},go=s(()=>t("div",{class:"text-sm mt-2"},"Average Monthly Balance",-1)),wo={class:"flex-1 text- text-md font-semibold"},Mo=s(()=>t("div",{class:"text-sm mt-2"},"Average Weekly Balance",-1)),To=s(()=>t("div",{class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},[t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate")]),t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow")])],-1)),Ao={class:"p-2 rounded-lg shadow-md"},Oo=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-2"}," Credit & Debit Summary ",-1)),ko={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Yo={class:"bg-white p-4 rounded-lg shadow"},So=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Monthly Credit & Debit",-1)),Ro={class:"overflow-y-auto max-h-96"},Do={class:"min-w-full table-auto text-sm text-left text-gray-600"},Io=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),jo={class:"px-2 py-2"},No={class:"px-2 py-2"},Eo={class:"px-2 py-2"},Lo={class:"bg-white p-4 rounded-lg shadow"},$o=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Weekly Credit & Debit",-1)),Bo={class:"overflow-y-auto max-h-96"},Co={class:"min-w-full table-auto text-sm text-left text-gray-600"},Vo=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),Uo={class:"px-2 py-2"},Wo={class:"px-2 py-2"},qo={class:"px-2 py-2"},Po={class:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm"},Ho={class:"bg-white p-6 rounded-2xl shadow-md"},Go=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Loan Analysis",-1)),zo={class:"space-y-2"},Fo={class:"flex justify-between"},Ko=s(()=>t("span",null,"Number of Loan Transactions",-1)),Jo={class:"flex justify-between"},Xo=s(()=>t("span",null,"Total Loan Amount",-1)),Qo={class:"flex justify-between"},Zo=s(()=>t("span",null,"Average Monthly Loan Amount",-1)),tn={class:"flex justify-between"},en=s(()=>t("span",null,"Total Loan Repayment Amount",-1)),sn={class:"flex justify-between"},on=s(()=>t("span",null,"Average Monthly Loan Repayment Amount",-1)),nn={class:"flex justify-between"},an=s(()=>t("span",null,"Loan to Inflow Rate",-1)),ln={class:"flex justify-between"},dn=s(()=>t("span",null,"Latest Loan Transaction Date",-1)),cn={class:"flex justify-between"},rn=s(()=>t("span",null,"Latest Loan Repayment Transaction Date",-1)),un={class:"bg-white p-6 rounded-2xl shadow-md"},_n=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Patterns",-1)),mn={class:"space-y-2"},fn={class:"flex justify-between"},pn=s(()=>t("span",null,"Account Sweep",-1)),vn={class:"flex justify-between"},hn=s(()=>t("span",null,"Number of Betting Transactions",-1)),yn={class:"flex justify-between"},xn=s(()=>t("span",null,"Gambling Rate",-1)),bn={class:"flex justify-between"},gn=s(()=>t("span",null,"Percentage of Debit Transactions",-1)),wn={class:"flex justify-between"},Mn=s(()=>t("span",null,"Percentage of Credit Transactions",-1)),Tn={class:"flex justify-between"},An=s(()=>t("span",null,"Percentage of Transactions between 500k - 1M",-1)),On={class:"flex justify-between"},kn=s(()=>t("span",null,"Percentage of Transactions Greater Than 1M",-1)),Yn={class:"flex justify-between"},Sn=s(()=>t("span",null,"Most Frequent Balance Range",-1)),Rn={class:"flex flex-wrap gap-4 justify-between mt-4"},Dn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},In={class:"grid grid-cols-3 gap-4 text-sm md:text-base"},jn=s(()=>t("div",null,null,-1)),Nn=s(()=>t("div",{class:"text-center font-medium"},"Outflow",-1)),En=s(()=>t("div",{class:"text-center font-medium"},"Inflow",-1)),Ln=s(()=>t("div",{class:"text-left"},"Number of Self Transfers",-1)),$n={class:"text-center font-semibold"},Bn={class:"text-center font-semibold"},Cn=s(()=>t("div",{class:"text-left"},"Value of Self Transfers",-1)),Vn={class:"text-center font-semibold"},Un={class:"text-center font-semibold"},Wn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},qn={class:"grid grid-cols-2 gap-4 text-center"},Pn={class:"text-2xl font-bold"},Hn=s(()=>t("div",{class:"text-sm"},"Total Transactions",-1)),Gn={class:"text-2xl font-bold"},zn=s(()=>t("div",{class:"text-sm"},"Returned Cheque",-1)),Fn={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},Kn={class:"w-full md:w-1/2"},Jn=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Self Transfer Transactions ",-1)),Xn={class:"bg-white rounded-xl border shadow p-4 max-h-96 overflow-y-auto"},Qn={class:"w-full text-sm text-left"},Zn=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),ta={key:0},ea=s(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),sa=[ea],oa={class:"py-2 px-4"},na={class:"py-2 px-4"},aa={class:"py-2 px-4"},la={class:"w-full md:w-1/2"},da=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Account Balance Analysis ",-1)),ia={class:"bg-white border rounded-xl shadow p-4 max-h-96 overflow-y-auto"},ca={class:"w-full text-sm text-left"},ra=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),ua={class:"py-2 px-4"},_a={class:"py-2 px-4"},ma={class:"py-2 px-4"},fa={class:"py-4"},pa=s(()=>t("span",{class:"text-2xl font-semibold"},"Transaction History",-1)),va=s(()=>t("i",{class:"fas fa-filter text-black-600 text-lg"},null,-1)),ha=s(()=>t("thead",{class:"font-semibold text-gray-600"},[t("tr",null,[t("th",{class:"px-2 py-3 font-semibold"},"S/N"),t("th",{class:"px-2 py-3 font-semibold"},"Date"),t("th",{class:"px-2 py-3 font-semibold"},"Description"),t("th",{class:"px-2 py-3 font-semibold"},"Type"),t("th",{class:"px-2 py-3 font-semibold"},"Amount"),t("th",{class:"px-2 py-3 font-semibold"},"Balance")])],-1)),ya={class:"px-2 py-4"},xa={class:"px-2 py-4"},ba={class:"px-2 py-4"},ga={class:"px-2 py-4"},wa={class:"px-2 py-4"},Ma=s(()=>t("span",null,"1â€“12 of 12",-1)),Ta={class:"flex items-center space-x-2"},Aa=s(()=>t("span",null,"Rows per page:",-1)),Oa={class:"flex justify-between items-center mb-4"},ka=s(()=>t("h2",{class:"text-lg font-semibold"},"Filter Transactions",-1)),Ya=s(()=>t("i",{class:"fas fa-sign-out-alt"},null,-1)),Sa=[Ya],Ra={class:"space-y-4"},Da=s(()=>t("label",{class:"text-sm font-medium"},"Date",-1)),Ia={class:"flex gap-2 mt-1"},ja=s(()=>t("label",{class:"text-sm font-medium"},"Type",-1)),Na={class:"flex gap-2"},Ea={class:"flex justify-end gap-2 mt-4"},La={__name:"StatementAnalysis",setup(q){const lt=o(!1),P=o(!1),p=Le({dateRange:[null,null]}),dt=re(()=>r(p.dateRange[0])),H=re(()=>r(p.dateRange[1])),g=o(!1),it=()=>{p.value={dateFrom:"",dateTo:"",description:"",type:"All",amountMin:"",amountMax:""}},L=o("Summary"),r=f=>A(f).format("MMMM Do YYYY,");function a(f){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(f||0)}const Y=o(15),_=$e(),h=Be(),ft=o(null),U=o(!0),G=o(null),ct=o(""),z=o(""),$=o(""),wt=o(""),Mt=o(0),Tt=o(0),pt=o(0),vt=o(0),ht=o(0),At=o(0),Ot=o(0),fe=o(0),kt=o(0),Yt=o(0),pe=o(0),St=o(0),Rt=o([]),Dt=o([]),It=o(0),jt=o(0),Nt=o(0),Et=o(""),Lt=o([]),$t=o(""),Bt=o(""),Ct=o(""),Vt=o(""),Ut=o(0),yt=o(""),Wt=o(0),qt=o(""),ve=o(0),he=o(0),Pt=o(0),Ht=o(0),Gt=o(0),zt=o(0),Ft=o(0),ye=o(0),xe=o(0),Kt=o(""),Jt=o([]),Xt=o(""),be=o(""),ge=o(0),we=o(""),Qt=o(0),Zt=o(0),te=o(0),ee=o(0),se=o(0),oe=o(0),ne=o(0),rt=o([]),ae=o([]),xt=o([]),bt=o([]),Me=async f=>{var T,R,N,E,D,W,F,K,J,ut,V,Z,tt;const i=JSON.parse(localStorage.getItem("data")||"{}"),j=(i==null?void 0:i.token)||h.token,M=`https://dev02201.getjupita.com/api/${((T=i==null?void 0:i.user)==null?void 0:T.tenant_id)||h.tenant_id}/get-analysis-result?analysis_id=${f}`;U.value=!0;try{let de=function(d){return A(d,"M-YYYY").format("MMM YYYY")};const C=await mt.get(M,{headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",C),ft.value=C.data;const e=(E=(N=(R=C.data)==null?void 0:R.data)==null?void 0:N.analysis_result)==null?void 0:E.analysis_result;ct.value=(e==null?void 0:e.name)||"N/A",z.value=(e==null?void 0:e.clientFullName)||"N/A",wt.value=(e==null?void 0:e.accountId)||"N/A";const u=(e==null?void 0:e.behavioralAnalysis)||{};yt.value=u.accountSweep||"No",Wt.value=u.gamblingRate||0,qt.value=u.gamblingStatus||"N/A",ve.value=u.loanInflowRate||0,he.value=u.accountActivity||0,Pt.value=u.totalLoanAmount||0,Ht.value=u.loanToInflowRate||0,Gt.value=u.numberLoanTransactions||0,zt.value=u.averageMonthlyLoanAmount||0,Ft.value=u.totalLoanRepaymentAmount||0,ye.value=u.loanRepaymentToInflowRate||0,xe.value=u.numberRepaymentTransactions||0,Jt.value=u.latestRepaymentTransaction||[];const _t=Jt.value[0]||null;Xt.value=_t!=null&&_t.date?A(_t.date).format("MMM D, YYYY"):"N/A";const le=(D=u.latestLoanTransaction)==null?void 0:D[0];Kt.value=le?A(le.date).format("MMMM D, YYYY"):"N/A",be.value=u.overallInflowToOutflowRate||"N/A",ge.value=u.percentOfInflowIrregularity||0,we.value=u.monthToMonthInflowToOutflowRate||"N/A",Qt.value=u.averageMonthlyLoanRepaymentAmount||0;const l=e==null?void 0:e.cashFlowAnalysis;console.log("cash flow data:",l),It.value=e==null?void 0:e.spendAnalysis.mostFrequentExpense,jt.value=e==null?void 0:e.spendAnalysis.mostFrequentExpenseAmount;const x=((J=(K=(F=(W=C.data)==null?void 0:W.data)==null?void 0:F.analysis_result)==null?void 0:K.analysis_result)==null?void 0:J.spendAnalysis)||{},k=((tt=(Z=(V=(ut=C.data)==null?void 0:ut.data)==null?void 0:V.analysis_result)==null?void 0:Z.analysis_result)==null?void 0:tt.transactionPatternAnalysis)||{};console.log("pattern analysis:",k),$t.value=(k.percentDebitTransactions*100).toFixed(2)+"%",Bt.value=(k.percentDebitTransactions*100).toFixed(2)+"%",Ct.value=(k.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",Vt.value=(k.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",Ut.value=k.mostFrequentBalanceRange,Zt.value=k.noOfSelfTransferInflows,te.value=k.noOfSelfTransferOutflows,ee.value=k.selfTransferInflowAmount,se.value=k.selfTransferOutflowAmount,oe.value=k.totalNumberOfTransactions,ne.value=k.returnCheque;const ke=k.selfTransferInflowTransactionsByMonth||[],Ye=k.selfTransferOutflowTransactionsByMonth||[],et=new Map;ke.forEach(d=>{const v=de(d.date);et.set(v,{month:v,inflow:d.amount,outflow:0})}),Ye.forEach(d=>{const v=de(d.date);et.has(v)?et.get(v).outflow=d.amount:et.set(v,{month:v,inflow:0,outflow:d.amount})}),rt.value=Array.from(et.values()).sort((d,v)=>A(d.month,"MMM YYYY")-A(v.month,"MMM YYYY")),Nt.value=x.highestSpend,Et.value=A(x.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Lt.value=[{label:"Others",monthly:x.averageMonthlySpendOnOthers??0,total:12*(x.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:x.averageMonthlySpendOnRent??0,total:12*(x.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:x.averageMonthlySpendOnHospitalityAndFood??0,total:12*(x.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:x.averageMonthlySpendOnTransportation??0,total:12*(x.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:x.averageMonthlySpendOnUtilities??0,total:12*(x.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:x.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(x.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:x.averageMonthlySpendOnTransfer??0,total:12*(x.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:x.averageMonthlySpendOnAtmAndPOS??0,total:12*(x.averageMonthlySpendOnAtmAndPOS??0)}],Mt.value=(l==null?void 0:l.totalDebitTurnOver)||0,Tt.value=(l==null?void 0:l.totalCreditTurnover)||0,pt.value=(l==null?void 0:l.averageMonthlyDebits)||0,vt.value=(l==null?void 0:l.averageMonthlyCredits)||0,ht.value=(l==null?void 0:l.averageMonthlyBalance)||0,At.value=(l==null?void 0:l.averageWeeklyBalance)||0,Ot.value=(l==null?void 0:l.totalCreditTurnover)||0,fe.value=(l==null?void 0:l.averageMonthlyCredits)||0,kt.value=(l==null?void 0:l.averageWeeklyCredits)||0,Yt.value=(l==null?void 0:l.totalDebitTurnOver)||0,pe.value=(l==null?void 0:l.averageMonthlyDebits)||0,St.value=(l==null?void 0:l.averageWeeklyDebits)||0;const Se=(l==null?void 0:l.monthlyHighestBalance)||[],Re=(l==null?void 0:l.monthlyLowestBalance)||[],st=new Map;Se.forEach(d=>{const v=`${d.month_name} ${d.year}`,S=A(v,"MMMM YYYY").format("MMM YYYY"),I=`${d.month_name}-${d.year}`;st.set(I,{month:S,highest:d.highest_balance,lowest:0})}),Re.forEach(d=>{const v=`${d.month_name} ${d.year}`,S=A(v,"MMMM YYYY").format("MMM YYYY"),I=`${d.month_name}-${d.year}`;st.has(I)?st.get(I).lowest=d.lowest_balance:st.set(I,{month:S,highest:0,lowest:d.lowest_balance})}),ae.value=Array.from(st.values());const De=(l==null?void 0:l.monthlyInflow)||[],Ie=(l==null?void 0:l.monthlyOutflow)||[],ot=new Map;De.forEach(d=>{const v=`${d.month_name} ${d.year}`,S=A(v,"MMMM YYYY").format("MMM YYYY"),I=`${d.month_name}-${d.year}`;ot.set(I,{month:S,credit:d.amount,debit:0})}),Ie.forEach(d=>{const v=`${d.month_name} ${d.year}`,S=A(v,"MMMM YYYY").format("MMM YYYY"),I=`${d.month_name}-${d.year}`;ot.has(I)?ot.get(I).debit=d.amount:ot.set(I,{month:S,credit:0,debit:d.amount})}),Rt.value=Array.from(ot.values());const je=(l==null?void 0:l.weeklyInflow)||[],Ne=(l==null?void 0:l.weeklyOutflow)||[],nt=new Map;je.forEach(d=>{const v=A().month(d.month_name).format("MMM"),S=`${d.year}-${v}-W${d.week}`;nt.set(S,{week:`${v} ${d.year} | ${d.week}`,credit:d.amount,debit:0})}),Ne.forEach(d=>{const v=A().month(d.month_name).format("MMM"),S=`${d.year}-${v}-W${d.week}`;nt.has(S)?nt.get(S).debit=d.amount:nt.set(S,{week:`${v} ${d.year} ${d.week}`,credit:0,debit:d.amount})}),Dt.value=Array.from(nt.values());const ie=new Date(e==null?void 0:e.startDate),ce=new Date(e==null?void 0:e.endDate);!isNaN(ie)&&!isNaN(ce)?$.value=`${A(ie).format("MMMM D, YYYY")} - ${A(ce).format("MMMM D, YYYY")}`:$.value="Unknown period"}catch(C){console.error("Error fetching analysis result:",C),G.value="Unable to fetch analysis result."}finally{U.value=!1}},Te=async()=>{var T;const f=JSON.parse(localStorage.getItem("data")||"{}"),i=(f==null?void 0:f.token)||h.token,j=((T=f==null?void 0:f.user)==null?void 0:T.tenant_id)||h.tenant_id,B=_.params.id,M=`https://dev02201.getjupita.com/api/${j}/get-statement-transactions?analysis_id=${B}`;try{const R=await mt.get(M,{headers:{Authorization:`Bearer ${i}`}});console.log("fetch transactions response:",R),bt.value=R.data.data.transactions,xt.value=[...bt.value]}catch(R){console.error(R)}},Ae=()=>{xt.value=bt.value.filter(f=>{const i=!p.description||f.description.toLowerCase().includes(p.description.toLowerCase()),j=new Date(f.date),B=p.dateRange[0]?new Date(p.dateRange[0]):null,M=p.dateRange[1]?new Date(p.dateRange[1]):null,T=(!B||j>=B)&&(!M||j<=M);return i&&T}),g.value=!1};Ce(()=>{Te();const f=_.params.id;f?Me(f):(G.value="Invalid analysis ID.",U.value=!1)});const Oe=async()=>{var T,R,N;const f=JSON.parse(localStorage.getItem("data")||"{}"),i=(f==null?void 0:f.token)||h.token,j=((T=f==null?void 0:f.user)==null?void 0:T.tenant_id)||h.tenant_id,B=_.params.id,M=`https://dev02201.getjupita.com/api/${j}/download-insight-report?analysis_id=${B}`;try{gt({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const E=await mt.get(M,{headers:{Authorization:`Bearer ${i}`}}),D=(N=(R=E==null?void 0:E.data)==null?void 0:R.data)==null?void 0:N.download;if(!(D!=null&&D.document_url)||!(D!=null&&D.document_name))throw new Error("No download information or document URL found in the response.");const W=D.document_url,K="analysis_report.pdf",J=await mt.get(W,{responseType:"blob"});He.saveAs(J.data,K),gt({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(E){console.error("Download failed:",E),gt({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(f,i)=>{const j=b("v-progress-circular"),B=b("RouterLink"),M=b("v-btn"),T=b("v-tab"),R=b("v-tabs"),N=b("v-tabs-window-item"),E=b("v-card-title"),D=b("v-table"),W=b("v-select"),F=b("v-icon"),K=b("v-card-actions"),J=b("v-card"),ut=b("v-tabs-window"),V=b("v-text-field"),Z=b("v-date-picker"),tt=b("v-menu"),C=b("v-navigation-drawer");return w(),Ve(Ue,null,{default:m(()=>[t("div",Ge,[ze,U.value?(w(),O("div",Fe,[c(j,{size:100,width:10,color:"primary",indeterminate:""})])):(w(),O("div",Ke,[t("div",Je,[c(B,{to:"/dashboard"},{default:m(()=>[t("button",{onClick:i[0]||(i[0]=(...e)=>f.goBack&&f.goBack(...e)),class:"mb-2 flex items-center text-blue-600 font-semibold"},[Xe,y(" Back ")])]),_:1}),t("div",Qe,[c(M,{onClick:Oe,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:m(()=>[Ze,y(" Download Analysis ")]),_:1})])]),t("div",ts,[t("p",null,[es,ss,y(),os,y(" "+n($.value),1)]),t("p",null,[ns,as,y(),ls,y(" "+n(z.value),1)]),t("p",null,[ds,is,y(),cs,y(" "+n(wt.value),1)])]),t("div",rs,[c(R,{"align-tabs":"center",class:"mb-6",modelValue:L.value,"onUpdate:modelValue":i[1]||(i[1]=e=>L.value=e),color:"primary"},{default:m(()=>[c(T,{value:"summary"},{default:m(()=>[y("Summary")]),_:1}),c(T,{value:"cash flow"},{default:m(()=>[y("Cash Flow")]),_:1}),c(T,{value:"behavioral"},{default:m(()=>[y("Behavioral")]),_:1}),c(T,{value:"transactions"},{default:m(()=>[y("Transactions")]),_:1})]),_:1},8,["modelValue"]),c(ut,{modelValue:L.value,"onUpdate:modelValue":i[4]||(i[4]=e=>L.value=e)},{default:m(()=>[c(N,{value:"summary"},{default:m(()=>[t("div",us,[t("div",_s,[t("div",ms,n(a(Tt.value)),1),fs]),t("div",ps,[t("div",vs,n(a(Mt.value)),1),hs]),t("div",ys,[t("div",xs,n(a(vt.value)),1),bs]),t("div",gs,[t("div",ws,n(a(pt.value)),1),Ms]),t("div",Ts,[t("div",As,n(a(ht.value)),1),Os])]),t("div",ks,[t("div",Ys,[Ss,t("p",Rs,[y(n(It.value),1),Ds])]),t("div",Is,[js,t("p",Ns,n(a(Nt.value)),1),t("p",Es," Transaction Date: "+n(Et.value),1)]),t("div",Ls,[$s,t("p",Bs,n(a(jt.value)),1)])]),t("div",Cs,[Vs,t("table",Us,[Ws,t("tbody",null,[(w(!0),O(X,null,Q(Lt.value,(e,u)=>(w(),O("tr",{key:u,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",qs,n(e.label),1),t("td",Ps,n(a(e.monthly)),1),t("td",Hs,n(a(e.total)),1)]))),128))])])])]),_:1}),c(N,{value:"cash flow"},{default:m(()=>[t("div",Gs,[t("div",zs,[Fs,t("div",Ks,[t("div",Js,[Xs,t("span",Qs,n(a(Ot.value)),1)]),t("div",Zs,[to,t("span",eo,n(a(vt.value)),1)]),t("div",so,[oo,t("span",no,n(a(kt.value)),1)])])]),t("div",ao,[lo,t("div",io,[t("div",co,[ro,t("span",uo,n(a(Yt.value)),1)]),t("div",_o,[mo,t("span",fo,n(a(pt.value)),1)]),t("div",po,[vo,t("span",ho,n(a(St.value)),1)])])])]),t("div",yo,[t("div",xo,[t("div",bo,[y(n(a(ht.value))+" ",1),go]),t("div",wo,[y(n(a(At.value))+" ",1),Mo])]),To]),t("div",Ao,[Oo,t("div",ko,[t("div",Yo,[So,t("div",Ro,[t("table",Do,[Io,t("tbody",null,[(w(!0),O(X,null,Q(Rt.value,(e,u)=>(w(),O("tr",{key:u,class:"border-b"},[t("td",jo,n(e.month),1),t("td",No,n(a(e.credit)),1),t("td",Eo,n(a(e.debit)),1)]))),128))])])])]),t("div",Lo,[$o,t("div",Bo,[t("table",Co,[Vo,t("tbody",null,[(w(!0),O(X,null,Q(Dt.value,(e,u)=>(w(),O("tr",{key:u,class:"border-b"},[t("td",Uo,n(e.week),1),t("td",Wo,n(a(e.credit)),1),t("td",qo,n(a(e.debit)),1)]))),128))])])])])])])]),_:1}),c(N,{value:"behavioral"},{default:m(()=>[t("div",Po,[t("div",Ho,[Go,t("div",zo,[t("div",Fo,[Ko,t("span",null,n(Gt.value),1)]),t("div",Jo,[Xo,t("span",null,n(a(Pt.value)),1)]),t("div",Qo,[Zo,t("span",null,n(a(zt.value)),1)]),t("div",tn,[en,t("span",null,n(a(Ft.value)),1)]),t("div",sn,[on,t("span",null,n(a(Qt.value)),1)]),t("div",nn,[an,t("span",null,n(Ht.value)+"%",1)]),t("div",ln,[dn,t("span",null,n(Kt.value),1)]),t("div",cn,[rn,t("span",null,n(Xt.value),1)])])]),t("div",un,[_n,t("div",mn,[t("div",fn,[pn,t("span",{class:ue(["font-semibold",yt.value==="YES"?"text-green-600":"text-gray-600"])},n(yt.value),3)]),t("div",vn,[hn,t("span",null,n(qt.value),1)]),t("div",yn,[xn,t("span",null,n(Wt.value),1)]),t("div",bn,[gn,t("span",null,n($t.value),1)]),t("div",wn,[Mn,t("span",null,n(Bt.value),1)]),t("div",Tn,[An,t("span",null,n(Ct.value),1)]),t("div",On,[kn,t("span",null,n(Vt.value),1)]),t("div",Yn,[Sn,t("span",null,n(Ut.value),1)])])])]),t("div",Rn,[t("div",Dn,[t("div",In,[jn,Nn,En,Ln,t("div",$n,n(te.value),1),t("div",Bn,n(Zt.value),1),Cn,t("div",Vn,n(a(se.value)),1),t("div",Un,n(a(ee.value)),1)])]),t("div",Wn,[t("div",qn,[t("div",null,[t("div",Pn,n(oe.value),1),Hn]),t("div",null,[t("div",Gn,n(ne.value),1),zn])])])]),t("div",Fn,[t("div",Kn,[Jn,t("div",Xn,[t("table",Qn,[Zn,t("tbody",null,[!rt.value||rt.value.length===0?(w(),O("tr",ta,sa)):We("",!0),(w(!0),O(X,null,Q(rt.value,(e,u)=>(w(),O("tr",{key:u,class:"border-b last:border-none"},[t("td",oa,n(e.month),1),t("td",na,n(a(e.inflow)),1),t("td",aa,n(a(e.outflow)),1)]))),128))])])])]),t("div",la,[da,t("div",ia,[t("table",ca,[ra,t("tbody",null,[(w(!0),O(X,null,Q(ae.value,(e,u)=>(w(),O("tr",{key:u},[t("td",ua,n(e.month),1),t("td",_a,n(a(e.highest)),1),t("td",ma,n(a(e.lowest)),1)]))),128))])])])])])]),_:1}),c(N,{value:"transactions"},{default:m(()=>[t("div",fa,[c(J,{class:"rounded-lg shadow-md"},{default:m(()=>[c(E,{class:"d-flex justify-between items-center px-6 py-4"},{default:m(()=>[pa,c(M,{onClick:i[2]||(i[2]=e=>g.value=!0),icon:"",variant:"text"},{default:m(()=>[va]),_:1})]),_:1}),c(D,{class:"min-w-full text-sm pa-4"},{default:m(()=>[ha,t("tbody",null,[(w(!0),O(X,null,Q(xt.value,(e,u)=>(w(),O("tr",{key:u,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",ya,n(u+1),1),t("td",xa,n(r(e.date)),1),t("td",ba,n(e.description),1),t("td",{class:ue(["px-6 py-4 font-semibold",e.type==="CREDIT"?"text-green-600":"text-red-600"])},n(e.type),3),t("td",ga,n(a(e.amount)),1),t("td",wa,n(a(e.balance)),1)]))),128))])]),_:1}),c(K,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:m(()=>[Ma,t("div",Ta,[Aa,c(W,{items:[15,30,45],modelValue:Y.value,"onUpdate:modelValue":i[3]||(i[3]=e=>Y.value=e),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),c(M,{icon:"",density:"comfortable"},{default:m(()=>[c(F,null,{default:m(()=>[y("mdi-chevron-left")]),_:1})]),_:1}),c(M,{icon:"",density:"comfortable"},{default:m(()=>[c(F,null,{default:m(()=>[y("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),c(C,{modelValue:g.value,"onUpdate:modelValue":i[16]||(i[16]=e=>g.value=e),location:"right",temporary:"",width:"500",class:"px-4 pt-6"},{default:m(()=>[t("div",Oa,[ka,t("div",{icon:"",onClick:i[5]||(i[5]=e=>g.value=!1)},Sa)]),t("div",Ra,[t("div",null,[Da,t("div",Ia,[c(tt,{modelValue:lt.value,"onUpdate:modelValue":i[8]||(i[8]=e=>lt.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:m(({props:e})=>[c(V,_e({"model-value":dt.value,label:"From",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16,["model-value"])]),default:m(()=>[c(Z,{modelValue:p.dateRange[0],"onUpdate:modelValue":[i[6]||(i[6]=e=>p.dateRange[0]=e),i[7]||(i[7]=e=>lt.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"]),c(tt,{modelValue:P.value,"onUpdate:modelValue":i[11]||(i[11]=e=>P.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:m(({props:e})=>[c(V,_e({"model-value":H.value,label:"To",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16,["model-value"])]),default:m(()=>[c(Z,{modelValue:p.dateRange[1],"onUpdate:modelValue":[i[9]||(i[9]=e=>p.dateRange[1]=e),i[10]||(i[10]=e=>P.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),t("div",null,[c(V,{color:"blue",label:"Description",modelValue:p.description,"onUpdate:modelValue":i[12]||(i[12]=e=>p.description=e),density:"compact",variant:"outlined",placeholder:"Enter description"},null,8,["modelValue"])]),t("div",null,[ja,c(W,{color:"blue",modelValue:p.type,"onUpdate:modelValue":i[13]||(i[13]=e=>p.type=e),items:["CREDIT","DEBIT"],density:"compact",variant:"outlined",placeholder:"Select type"},null,8,["modelValue"])]),t("div",Na,[c(V,{color:"blue",modelValue:p.minAmount,"onUpdate:modelValue":i[14]||(i[14]=e=>p.minAmount=e),label:"Min Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"]),c(V,{color:"blue",modelValue:p.maxAmount,"onUpdate:modelValue":i[15]||(i[15]=e=>p.maxAmount=e),label:"Max Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"])]),t("div",Ea,[c(M,{onClick:Ae,variant:"tonal",color:"primary"},{default:m(()=>[y("Apply")]),_:1}),c(M,{onClick:it,variant:"text",color:"grey"},{default:m(()=>[y("Reset")]),_:1})])])]),_:1},8,["modelValue"])]))])]),_:1})}}},Ba=Ee(La,[["__scopeId","data-v-4cf84915"]]);export{Ba as default};
