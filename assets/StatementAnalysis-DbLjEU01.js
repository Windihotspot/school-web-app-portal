import{b as lt,_ as Ne,r as o,e as Ee,f as re,u as Le,g as $e,o as Be,h as g,i as M,j as Ve,w as m,M as Ce,k as ft,l as T,m as t,n as A,p as c,q as y,t as n,F as J,s as X,v as ue,x as Ue,y as _e,E as bt,z as We,A as qe}from"./index-UR0u2Z1j.js";var me={exports:{}};(function(W,dt){(function(q,h){h()})(lt,function(){function q(r,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function h(r,u,i){var f=new XMLHttpRequest;f.open("GET",r),f.responseType="blob",f.onload=function(){H(f.response,u,i)},f.onerror=function(){console.error("could not download file")},f.send()}function it(r){var u=new XMLHttpRequest;u.open("HEAD",r,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function P(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(u)}}var w=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof lt=="object"&&lt.global===lt?lt:void 0,ct=w.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),H=w.saveAs||(typeof window!="object"||window!==w?function(){}:"download"in HTMLAnchorElement.prototype&&!ct?function(r,u,i){var f=w.URL||w.webkitURL,b=document.createElement("a");u=u||r.name||"download",b.download=u,b.rel="noopener",typeof r=="string"?(b.href=r,b.origin===location.origin?P(b):it(b.href)?h(r,u,i):P(b,b.target="_blank")):(b.href=f.createObjectURL(r),setTimeout(function(){f.revokeObjectURL(b.href)},4e4),setTimeout(function(){P(b)},0))}:"msSaveOrOpenBlob"in navigator?function(r,u,i){if(u=u||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(q(r,i),u);else if(it(r))h(r,u,i);else{var f=document.createElement("a");f.href=r,f.target="_blank",setTimeout(function(){P(f)})}}:function(r,u,i,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof r=="string")return h(r,u,i);var b=r.type==="application/octet-stream",L=/constructor/i.test(w.HTMLElement)||w.safari,rt=/CriOS\/[\d]+/.test(navigator.userAgent);if((rt||b&&L||ct)&&typeof FileReader<"u"){var $=new FileReader;$.onloadend=function(){var B=$.result;B=rt?B:B.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=B:location=B,f=null},$.readAsDataURL(r)}else{var Q=w.URL||w.webkitURL,Z=Q.createObjectURL(r);f?f.location=Z:location.href=Z,f=null,setTimeout(function(){Q.revokeObjectURL(Z)},4e4)}});w.saveAs=H.saveAs=H,W.exports=H})})(me);var Pe=me.exports;const s=W=>(We("data-v-7eb8fd72"),W=W(),qe(),W),He={class:"p-2 bg-[#f0f8ff]"},Ge=s(()=>t("h2",{class:"text-xl font-bold mt-2 ml-6"},"Statement Analysis Result",-1)),Fe={key:0,class:"flex items-center justify-center h-96"},ze={key:1,class:"p-2 md:p-8"},Ke={class:"flex justify-between"},Je=s(()=>t("i",{class:"fas fa-arrow-left mr-2"},null,-1)),Xe={class:"text-right"},Qe=s(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),Ze={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6"},ts=s(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),es=s(()=>t("strong",null,"Statement Period:",-1)),ss=s(()=>t("br",null,null,-1)),os=s(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),ns=s(()=>t("strong",null,"Account Name:",-1)),as=s(()=>t("br",null,null,-1)),ls=s(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),ds=s(()=>t("strong",null,"Account Number:",-1)),is=s(()=>t("br",null,null,-1)),cs={class:"mt-6"},rs={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4"},us={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},_s={class:"text-md font-semibold"},ms=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),fs={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ps={class:"text-md font-semibold"},vs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),hs={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ys={class:"text-md font-semibold"},xs=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),bs={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},gs={class:"text-md font-semibold"},ws=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),Ms={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},Ts={class:"text-md font-semibold"},As=s(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),Os={class:"flex flex-col md:flex-row gap-4 p-4"},ks={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Ys=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense",-1)),Ss={class:"font-semibold text-gray-800 leading-tight"},Rs=s(()=>t("br",null,null,-1)),Is={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},js=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Highest Spend",-1)),Ds={class:"font-semibold text-gray-800 text-lg"},Ns={class:"text-sm font-semibold text-gray-600 mt-1"},Es={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},Ls=s(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense Amount",-1)),$s={class:"font-semibold text-gray-800 text-lg"},Bs={class:"bg-white p-6 rounded-2xl shadow-md overflow-x-auto"},Vs=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 m-4"},"Expenses",-1)),Cs={class:"min-w-full table-auto border-collapse"},Us=s(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-semibold text-gray-600 border-b border-gray-200"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),Ws={class:"py-3 px-4"},qs={class:"py-3 px-4"},Ps={class:"py-3 px-4"},Hs={class:"flex flex-col md:flex-row gap-4 text-center text-gray-500 py-10"},Gs={class:"flex-1 bg-white border p-6 rounded-xl shadow"},Fs=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Inflow Summary",-1)),zs={class:"space-y-2"},Ks={class:"flex justify-between"},Js=s(()=>t("span",null,"Total Inflow",-1)),Xs={class:"text-green-600 font-bold"},Qs={class:"flex justify-between"},Zs=s(()=>t("span",null,"Average Monthly Inflow",-1)),to={class:"font-medium"},eo={class:"flex justify-between"},so=s(()=>t("span",null,"Average Weekly Inflow",-1)),oo={class:"font-medium"},no={class:"flex-1 bg-white border p-6 rounded-xl shadow"},ao=s(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Outflow Summary",-1)),lo={class:"space-y-2"},io={class:"flex justify-between"},co=s(()=>t("span",null,"Total Outflow",-1)),ro={class:"text-red-600 font-bold"},uo={class:"flex justify-between"},_o=s(()=>t("span",null,"Average Monthly Outflow",-1)),mo={class:"font-medium"},fo={class:"flex justify-between"},po=s(()=>t("span",null,"Average Weekly Outflow",-1)),vo={class:"font-medium"},ho={class:"flex gap-4 justify-between p-2"},yo={class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},xo={class:"flex-1 text-md font-semibold"},bo=s(()=>t("div",{class:"text-sm mt-2"},"Average Monthly Balance",-1)),go={class:"flex-1 text- text-md font-semibold"},wo=s(()=>t("div",{class:"text-sm mt-2"},"Average Weekly Balance",-1)),Mo=s(()=>t("div",{class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},[t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate")]),t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow")])],-1)),To={class:"p-2 rounded-lg shadow-md"},Ao=s(()=>t("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-2"}," Credit & Debit Summary ",-1)),Oo={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ko={class:"bg-white p-4 rounded-lg shadow"},Yo=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Monthly Credit & Debit",-1)),So={class:"overflow-y-auto max-h-96"},Ro={class:"min-w-full table-auto text-sm text-left text-gray-600"},Io=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),jo={class:"px-2 py-2"},Do={class:"px-2 py-2"},No={class:"px-2 py-2"},Eo={class:"bg-white p-4 rounded-lg shadow"},Lo=s(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Weekly Credit & Debit",-1)),$o={class:"overflow-y-auto max-h-96"},Bo={class:"min-w-full table-auto text-sm text-left text-gray-600"},Vo=s(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),Co={class:"px-2 py-2"},Uo={class:"px-2 py-2"},Wo={class:"px-2 py-2"},qo={class:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm"},Po={class:"bg-white p-6 rounded-2xl shadow-md"},Ho=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Loan Analysis",-1)),Go={class:"space-y-2"},Fo={class:"flex justify-between"},zo=s(()=>t("span",null,"Number of Loan Transactions",-1)),Ko={class:"flex justify-between"},Jo=s(()=>t("span",null,"Total Loan Amount",-1)),Xo={class:"flex justify-between"},Qo=s(()=>t("span",null,"Average Monthly Loan Amount",-1)),Zo={class:"flex justify-between"},tn=s(()=>t("span",null,"Total Loan Repayment Amount",-1)),en={class:"flex justify-between"},sn=s(()=>t("span",null,"Average Monthly Loan Repayment Amount",-1)),on={class:"flex justify-between"},nn=s(()=>t("span",null,"Loan to Inflow Rate",-1)),an={class:"flex justify-between"},ln=s(()=>t("span",null,"Latest Loan Transaction Date",-1)),dn={class:"flex justify-between"},cn=s(()=>t("span",null,"Latest Loan Repayment Transaction Date",-1)),rn={class:"bg-white p-6 rounded-2xl shadow-md"},un=s(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Patterns",-1)),_n={class:"space-y-2"},mn={class:"flex justify-between"},fn=s(()=>t("span",null,"Account Sweep",-1)),pn={class:"flex justify-between"},vn=s(()=>t("span",null,"Number of Betting Transactions",-1)),hn={class:"flex justify-between"},yn=s(()=>t("span",null,"Gambling Rate",-1)),xn={class:"flex justify-between"},bn=s(()=>t("span",null,"Percentage of Debit Transactions",-1)),gn={class:"flex justify-between"},wn=s(()=>t("span",null,"Percentage of Credit Transactions",-1)),Mn={class:"flex justify-between"},Tn=s(()=>t("span",null,"Percentage of Transactions between 500k - 1M",-1)),An={class:"flex justify-between"},On=s(()=>t("span",null,"Percentage of Transactions Greater Than 1M",-1)),kn={class:"flex justify-between"},Yn=s(()=>t("span",null,"Most Frequent Balance Range",-1)),Sn={class:"flex flex-wrap gap-4 justify-between mt-4"},Rn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},In={class:"grid grid-cols-3 gap-4 text-sm md:text-base"},jn=s(()=>t("div",null,null,-1)),Dn=s(()=>t("div",{class:"text-center font-medium"},"Outflow",-1)),Nn=s(()=>t("div",{class:"text-center font-medium"},"Inflow",-1)),En=s(()=>t("div",{class:"text-left"},"Number of Self Transfers",-1)),Ln={class:"text-center font-semibold"},$n={class:"text-center font-semibold"},Bn=s(()=>t("div",{class:"text-left"},"Value of Self Transfers",-1)),Vn={class:"text-center font-semibold"},Cn={class:"text-center font-semibold"},Un={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},Wn={class:"grid grid-cols-2 gap-4 text-center"},qn={class:"text-2xl font-bold"},Pn=s(()=>t("div",{class:"text-sm"},"Total Transactions",-1)),Hn={class:"text-2xl font-bold"},Gn=s(()=>t("div",{class:"text-sm"},"Returned Cheque",-1)),Fn={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},zn={class:"w-full md:w-1/2"},Kn=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Self Transfer Transactions ",-1)),Jn={class:"bg-white rounded-xl border shadow p-4 max-h-96 overflow-y-auto"},Xn={class:"w-full text-sm text-left"},Qn=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),Zn={key:0},ta=s(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),ea=[ta],sa={class:"py-2 px-4"},oa={class:"py-2 px-4"},na={class:"py-2 px-4"},aa={class:"w-full md:w-1/2"},la=s(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Account Balance Analysis ",-1)),da={class:"bg-white border rounded-xl shadow p-4 max-h-96 overflow-y-auto"},ia={class:"w-full text-sm text-left"},ca=s(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),ra={class:"py-2 px-4"},ua={class:"py-2 px-4"},_a={class:"py-2 px-4"},ma={class:"py-4"},fa=s(()=>t("span",{class:"text-2xl font-semibold"},"Transaction History",-1)),pa=s(()=>t("i",{class:"fas fa-filter text-black-600 text-lg"},null,-1)),va=s(()=>t("thead",{class:"font-semibold text-gray-600"},[t("tr",null,[t("th",{class:"px-2 py-3 font-semibold"},"S/N"),t("th",{class:"px-2 py-3 font-semibold"},"Date"),t("th",{class:"px-2 py-3 font-semibold"},"Description"),t("th",{class:"px-2 py-3 font-semibold"},"Type"),t("th",{class:"px-2 py-3 font-semibold"},"Amount"),t("th",{class:"px-2 py-3 font-semibold"},"Balance")])],-1)),ha={class:"px-2 py-4"},ya={class:"px-2 py-4"},xa={class:"px-2 py-4"},ba={class:"px-2 py-4"},ga={class:"px-2 py-4"},wa=s(()=>t("span",null,"1–12 of 12",-1)),Ma={class:"flex items-center space-x-2"},Ta=s(()=>t("span",null,"Rows per page:",-1)),Aa={class:"flex justify-between items-center mb-4"},Oa=s(()=>t("h2",{class:"text-lg font-semibold"},"Filter Transactions",-1)),ka=s(()=>t("i",{class:"fas fa-sign-out-alt"},null,-1)),Ya=[ka],Sa={class:"space-y-4"},Ra=s(()=>t("label",{class:"text-sm font-medium"},"Date",-1)),Ia={class:"flex gap-2 mt-1"},ja=s(()=>t("label",{class:"text-sm font-medium"},"Type",-1)),Da={class:"flex gap-2"},Na={class:"flex justify-end gap-2 mt-4"},Ea={__name:"StatementAnalysis",setup(W){const dt=o(!1),q=o(!1),h=Ee({dateRange:[null,null]}),it=re(()=>u(h.dateRange[0])),P=re(()=>u(h.dateRange[1])),w=o(!1),ct=()=>{h.value={dateFrom:"",dateTo:"",description:"",type:"All",amountMin:"",amountMax:""}},H=()=>{console.log("Filters applied:",h.value),w.value=!1},r=o("Summary"),u=p=>T(p).format("MMMM Do YYYY,");function i(p){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(p||0)}const f=o(15),b=Le(),L=$e(),rt=o(null),$=o(!0),Q=o(null),Z=o(""),B=o(""),pt=o(""),gt=o(""),wt=o(0),Mt=o(0),vt=o(0),ht=o(0),yt=o(0),Tt=o(0),At=o(0),fe=o(0),Ot=o(0),kt=o(0),pe=o(0),Yt=o(0),St=o([]),Rt=o([]),It=o(0),jt=o(0),Dt=o(0),Nt=o(""),Et=o([]),Lt=o(""),$t=o(""),Bt=o(""),Vt=o(""),Ct=o(0),xt=o(""),Ut=o(0),Wt=o(""),ve=o(0),he=o(0),qt=o(0),Pt=o(0),Ht=o(0),Gt=o(0),Ft=o(0),ye=o(0),xe=o(0),zt=o(""),Kt=o([]),Jt=o(""),be=o(""),ge=o(0),we=o(""),Xt=o(0),Qt=o(0),Zt=o(0),te=o(0),ee=o(0),se=o(0),oe=o(0),ut=o([]),ne=o([]),ae=o([]),Me=async p=>{var k,R,D,N,I,U,F,z,K,_t,V,tt,et;const d=JSON.parse(localStorage.getItem("data")||"{}"),C=(d==null?void 0:d.token)||L.token,S=`https://dev02201.getjupita.com/api/${((k=d==null?void 0:d.user)==null?void 0:k.tenant_id)||L.tenant_id}/get-analysis-result?analysis_id=${p}`;$.value=!0;try{let de=function(l){return T(l,"M-YYYY").format("MMM YYYY")};const E=await ft.get(S,{headers:{Authorization:`Bearer ${C}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",E),rt.value=E.data;const e=(N=(D=(R=E.data)==null?void 0:R.data)==null?void 0:D.analysis_result)==null?void 0:N.analysis_result;Z.value=(e==null?void 0:e.name)||"N/A",B.value=(e==null?void 0:e.clientFullName)||"N/A",gt.value=(e==null?void 0:e.accountId)||"N/A";const _=(e==null?void 0:e.behavioralAnalysis)||{};xt.value=_.accountSweep||"No",Ut.value=_.gamblingRate||0,Wt.value=_.gamblingStatus||"N/A",ve.value=_.loanInflowRate||0,he.value=_.accountActivity||0,qt.value=_.totalLoanAmount||0,Pt.value=_.loanToInflowRate||0,Ht.value=_.numberLoanTransactions||0,Gt.value=_.averageMonthlyLoanAmount||0,Ft.value=_.totalLoanRepaymentAmount||0,ye.value=_.loanRepaymentToInflowRate||0,xe.value=_.numberRepaymentTransactions||0,Kt.value=_.latestRepaymentTransaction||[];const mt=Kt.value[0]||null;Jt.value=mt!=null&&mt.date?T(mt.date).format("MMM D, YYYY"):"N/A";const le=(I=_.latestLoanTransaction)==null?void 0:I[0];zt.value=le?T(le.date).format("MMMM D, YYYY"):"N/A",be.value=_.overallInflowToOutflowRate||"N/A",ge.value=_.percentOfInflowIrregularity||0,we.value=_.monthToMonthInflowToOutflowRate||"N/A",Xt.value=_.averageMonthlyLoanRepaymentAmount||0;const a=e==null?void 0:e.cashFlowAnalysis;console.log("cash flow data:",a),It.value=e==null?void 0:e.spendAnalysis.mostFrequentExpense,jt.value=e==null?void 0:e.spendAnalysis.mostFrequentExpenseAmount;const x=((K=(z=(F=(U=E.data)==null?void 0:U.data)==null?void 0:F.analysis_result)==null?void 0:z.analysis_result)==null?void 0:K.spendAnalysis)||{},O=((et=(tt=(V=(_t=E.data)==null?void 0:_t.data)==null?void 0:V.analysis_result)==null?void 0:tt.analysis_result)==null?void 0:et.transactionPatternAnalysis)||{};console.log("pattern analysis:",O),Lt.value=(O.percentDebitTransactions*100).toFixed(2)+"%",$t.value=(O.percentDebitTransactions*100).toFixed(2)+"%",Bt.value=(O.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",Vt.value=(O.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",Ct.value=O.mostFrequentBalanceRange,Qt.value=O.noOfSelfTransferInflows,Zt.value=O.noOfSelfTransferOutflows,te.value=O.selfTransferInflowAmount,ee.value=O.selfTransferOutflowAmount,se.value=O.totalNumberOfTransactions,oe.value=O.returnCheque;const Oe=O.selfTransferInflowTransactionsByMonth||[],ke=O.selfTransferOutflowTransactionsByMonth||[],st=new Map;Oe.forEach(l=>{const v=de(l.date);st.set(v,{month:v,inflow:l.amount,outflow:0})}),ke.forEach(l=>{const v=de(l.date);st.has(v)?st.get(v).outflow=l.amount:st.set(v,{month:v,inflow:0,outflow:l.amount})}),ut.value=Array.from(st.values()).sort((l,v)=>T(l.month,"MMM YYYY")-T(v.month,"MMM YYYY")),Dt.value=x.highestSpend,Nt.value=T(x.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Et.value=[{label:"Others",monthly:x.averageMonthlySpendOnOthers??0,total:12*(x.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:x.averageMonthlySpendOnRent??0,total:12*(x.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:x.averageMonthlySpendOnHospitalityAndFood??0,total:12*(x.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:x.averageMonthlySpendOnTransportation??0,total:12*(x.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:x.averageMonthlySpendOnUtilities??0,total:12*(x.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:x.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(x.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:x.averageMonthlySpendOnTransfer??0,total:12*(x.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:x.averageMonthlySpendOnAtmAndPOS??0,total:12*(x.averageMonthlySpendOnAtmAndPOS??0)}],wt.value=(a==null?void 0:a.totalDebitTurnOver)||0,Mt.value=(a==null?void 0:a.totalCreditTurnover)||0,vt.value=(a==null?void 0:a.averageMonthlyDebits)||0,ht.value=(a==null?void 0:a.averageMonthlyCredits)||0,yt.value=(a==null?void 0:a.averageMonthlyBalance)||0,Tt.value=(a==null?void 0:a.averageWeeklyBalance)||0,At.value=(a==null?void 0:a.totalCreditTurnover)||0,fe.value=(a==null?void 0:a.averageMonthlyCredits)||0,Ot.value=(a==null?void 0:a.averageWeeklyCredits)||0,kt.value=(a==null?void 0:a.totalDebitTurnOver)||0,pe.value=(a==null?void 0:a.averageMonthlyDebits)||0,Yt.value=(a==null?void 0:a.averageWeeklyDebits)||0;const Ye=(a==null?void 0:a.monthlyHighestBalance)||[],Se=(a==null?void 0:a.monthlyLowestBalance)||[],ot=new Map;Ye.forEach(l=>{const v=`${l.month_name} ${l.year}`,Y=T(v,"MMMM YYYY").format("MMM YYYY"),j=`${l.month_name}-${l.year}`;ot.set(j,{month:Y,highest:l.highest_balance,lowest:0})}),Se.forEach(l=>{const v=`${l.month_name} ${l.year}`,Y=T(v,"MMMM YYYY").format("MMM YYYY"),j=`${l.month_name}-${l.year}`;ot.has(j)?ot.get(j).lowest=l.lowest_balance:ot.set(j,{month:Y,highest:0,lowest:l.lowest_balance})}),ne.value=Array.from(ot.values());const Re=(a==null?void 0:a.monthlyInflow)||[],Ie=(a==null?void 0:a.monthlyOutflow)||[],nt=new Map;Re.forEach(l=>{const v=`${l.month_name} ${l.year}`,Y=T(v,"MMMM YYYY").format("MMM YYYY"),j=`${l.month_name}-${l.year}`;nt.set(j,{month:Y,credit:l.amount,debit:0})}),Ie.forEach(l=>{const v=`${l.month_name} ${l.year}`,Y=T(v,"MMMM YYYY").format("MMM YYYY"),j=`${l.month_name}-${l.year}`;nt.has(j)?nt.get(j).debit=l.amount:nt.set(j,{month:Y,credit:0,debit:l.amount})}),St.value=Array.from(nt.values());const je=(a==null?void 0:a.weeklyInflow)||[],De=(a==null?void 0:a.weeklyOutflow)||[],at=new Map;je.forEach(l=>{const v=T().month(l.month_name).format("MMM"),Y=`${l.year}-${v}-W${l.week}`;at.set(Y,{week:`${v} ${l.year} | ${l.week}`,credit:l.amount,debit:0})}),De.forEach(l=>{const v=T().month(l.month_name).format("MMM"),Y=`${l.year}-${v}-W${l.week}`;at.has(Y)?at.get(Y).debit=l.amount:at.set(Y,{week:`${v} ${l.year} ${l.week}`,credit:0,debit:l.amount})}),Rt.value=Array.from(at.values());const ie=new Date(e==null?void 0:e.startDate),ce=new Date(e==null?void 0:e.endDate);!isNaN(ie)&&!isNaN(ce)?pt.value=`${T(ie).format("MMMM D, YYYY")} - ${T(ce).format("MMMM D, YYYY")}`:pt.value="Unknown period"}catch(E){console.error("Error fetching analysis result:",E),Q.value="Unable to fetch analysis result."}finally{$.value=!1}},Te=async()=>{var k;const p=JSON.parse(localStorage.getItem("data")||"{}"),d=(p==null?void 0:p.token)||L.token,C=((k=p==null?void 0:p.user)==null?void 0:k.tenant_id)||L.tenant_id,G=b.params.id,S=`https://dev02201.getjupita.com/api/${C}/get-statement-transactions?analysis_id=${G}`;try{const R=await ft.get(S,{headers:{Authorization:`Bearer ${d}`}});console.log("fetch transactions response:",R),ae.value=R.data.data.transactions}catch(R){console.error(R)}};Be(()=>{Te();const p=b.params.id;p?Me(p):(Q.value="Invalid analysis ID.",$.value=!1)});const Ae=async()=>{var k,R,D;const p=JSON.parse(localStorage.getItem("data")||"{}"),d=(p==null?void 0:p.token)||L.token,C=((k=p==null?void 0:p.user)==null?void 0:k.tenant_id)||L.tenant_id,G=b.params.id,S=`https://dev02201.getjupita.com/api/${C}/download-insight-report?analysis_id=${G}`;try{bt({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const N=await ft.get(S,{headers:{Authorization:`Bearer ${d}`}}),I=(D=(R=N==null?void 0:N.data)==null?void 0:R.data)==null?void 0:D.download;if(!(I!=null&&I.document_url)||!(I!=null&&I.document_name))throw new Error("No download information or document URL found in the response.");const U=I.document_url,z="analysis_report.pdf",K=await ft.get(U,{responseType:"blob"});Pe.saveAs(K.data,z),bt({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(N){console.error("Download failed:",N),bt({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(p,d)=>{const C=g("v-progress-circular"),G=g("RouterLink"),S=g("v-btn"),k=g("v-tab"),R=g("v-tabs"),D=g("v-tabs-window-item"),N=g("v-card-title"),I=g("v-table"),U=g("v-select"),F=g("v-icon"),z=g("v-card-actions"),K=g("v-card"),_t=g("v-tabs-window"),V=g("v-text-field"),tt=g("v-date-picker"),et=g("v-menu"),E=g("v-navigation-drawer");return M(),Ve(Ce,null,{default:m(()=>[t("div",He,[Ge,$.value?(M(),A("div",Fe,[c(C,{size:100,width:10,color:"primary",indeterminate:""})])):(M(),A("div",ze,[t("div",Ke,[c(G,{to:"/dashboard"},{default:m(()=>[t("button",{onClick:d[0]||(d[0]=(...e)=>p.goBack&&p.goBack(...e)),class:"mb-2 flex items-center text-blue-600 font-semibold"},[Je,y(" Back ")])]),_:1}),t("div",Xe,[c(S,{onClick:Ae,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:m(()=>[Qe,y(" Download Analysis ")]),_:1})])]),t("div",Ze,[t("p",null,[ts,es,y(),ss,y(" "+n(pt.value),1)]),t("p",null,[os,ns,y(),as,y(" "+n(B.value),1)]),t("p",null,[ls,ds,y(),is,y(" "+n(gt.value),1)])]),t("div",cs,[c(R,{"align-tabs":"center",class:"mb-6",modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=e=>r.value=e),color:"primary"},{default:m(()=>[c(k,{value:"summary"},{default:m(()=>[y("Summary")]),_:1}),c(k,{value:"cash flow"},{default:m(()=>[y("Cash Flow")]),_:1}),c(k,{value:"behavioral"},{default:m(()=>[y("Behavioral")]),_:1}),c(k,{value:"transactions"},{default:m(()=>[y("Transactions")]),_:1})]),_:1},8,["modelValue"]),c(_t,{modelValue:r.value,"onUpdate:modelValue":d[4]||(d[4]=e=>r.value=e)},{default:m(()=>[c(D,{value:"summary"},{default:m(()=>[t("div",rs,[t("div",us,[t("div",_s,n(i(Mt.value)),1),ms]),t("div",fs,[t("div",ps,n(i(wt.value)),1),vs]),t("div",hs,[t("div",ys,n(i(ht.value)),1),xs]),t("div",bs,[t("div",gs,n(i(vt.value)),1),ws]),t("div",Ms,[t("div",Ts,n(i(yt.value)),1),As])]),t("div",Os,[t("div",ks,[Ys,t("p",Ss,[y(n(It.value),1),Rs])]),t("div",Is,[js,t("p",Ds,n(i(Dt.value)),1),t("p",Ns," Transaction Date: "+n(Nt.value),1)]),t("div",Es,[Ls,t("p",$s,n(i(jt.value)),1)])]),t("div",Bs,[Vs,t("table",Cs,[Us,t("tbody",null,[(M(!0),A(J,null,X(Et.value,(e,_)=>(M(),A("tr",{key:_,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",Ws,n(e.label),1),t("td",qs,n(i(e.monthly)),1),t("td",Ps,n(i(e.total)),1)]))),128))])])])]),_:1}),c(D,{value:"cash flow"},{default:m(()=>[t("div",Hs,[t("div",Gs,[Fs,t("div",zs,[t("div",Ks,[Js,t("span",Xs,n(i(At.value)),1)]),t("div",Qs,[Zs,t("span",to,n(i(ht.value)),1)]),t("div",eo,[so,t("span",oo,n(i(Ot.value)),1)])])]),t("div",no,[ao,t("div",lo,[t("div",io,[co,t("span",ro,n(i(kt.value)),1)]),t("div",uo,[_o,t("span",mo,n(i(vt.value)),1)]),t("div",fo,[po,t("span",vo,n(i(Yt.value)),1)])])])]),t("div",ho,[t("div",yo,[t("div",xo,[y(n(i(yt.value))+" ",1),bo]),t("div",go,[y(n(i(Tt.value))+" ",1),wo])]),Mo]),t("div",To,[Ao,t("div",Oo,[t("div",ko,[Yo,t("div",So,[t("table",Ro,[Io,t("tbody",null,[(M(!0),A(J,null,X(St.value,(e,_)=>(M(),A("tr",{key:_,class:"border-b"},[t("td",jo,n(e.month),1),t("td",Do,n(i(e.credit)),1),t("td",No,n(i(e.debit)),1)]))),128))])])])]),t("div",Eo,[Lo,t("div",$o,[t("table",Bo,[Vo,t("tbody",null,[(M(!0),A(J,null,X(Rt.value,(e,_)=>(M(),A("tr",{key:_,class:"border-b"},[t("td",Co,n(e.week),1),t("td",Uo,n(i(e.credit)),1),t("td",Wo,n(i(e.debit)),1)]))),128))])])])])])])]),_:1}),c(D,{value:"behavioral"},{default:m(()=>[t("div",qo,[t("div",Po,[Ho,t("div",Go,[t("div",Fo,[zo,t("span",null,n(Ht.value),1)]),t("div",Ko,[Jo,t("span",null,n(i(qt.value)),1)]),t("div",Xo,[Qo,t("span",null,n(i(Gt.value)),1)]),t("div",Zo,[tn,t("span",null,n(i(Ft.value)),1)]),t("div",en,[sn,t("span",null,n(i(Xt.value)),1)]),t("div",on,[nn,t("span",null,n(Pt.value)+"%",1)]),t("div",an,[ln,t("span",null,n(zt.value),1)]),t("div",dn,[cn,t("span",null,n(Jt.value),1)])])]),t("div",rn,[un,t("div",_n,[t("div",mn,[fn,t("span",{class:ue(["font-semibold",xt.value==="YES"?"text-green-600":"text-gray-600"])},n(xt.value),3)]),t("div",pn,[vn,t("span",null,n(Wt.value),1)]),t("div",hn,[yn,t("span",null,n(Ut.value),1)]),t("div",xn,[bn,t("span",null,n(Lt.value),1)]),t("div",gn,[wn,t("span",null,n($t.value),1)]),t("div",Mn,[Tn,t("span",null,n(Bt.value),1)]),t("div",An,[On,t("span",null,n(Vt.value),1)]),t("div",kn,[Yn,t("span",null,n(Ct.value),1)])])])]),t("div",Sn,[t("div",Rn,[t("div",In,[jn,Dn,Nn,En,t("div",Ln,n(Zt.value),1),t("div",$n,n(Qt.value),1),Bn,t("div",Vn,n(i(ee.value)),1),t("div",Cn,n(i(te.value)),1)])]),t("div",Un,[t("div",Wn,[t("div",null,[t("div",qn,n(se.value),1),Pn]),t("div",null,[t("div",Hn,n(oe.value),1),Gn])])])]),t("div",Fn,[t("div",zn,[Kn,t("div",Jn,[t("table",Xn,[Qn,t("tbody",null,[!ut.value||ut.value.length===0?(M(),A("tr",Zn,ea)):Ue("",!0),(M(!0),A(J,null,X(ut.value,(e,_)=>(M(),A("tr",{key:_,class:"border-b last:border-none"},[t("td",sa,n(e.month),1),t("td",oa,n(i(e.inflow)),1),t("td",na,n(i(e.outflow)),1)]))),128))])])])]),t("div",aa,[la,t("div",da,[t("table",ia,[ca,t("tbody",null,[(M(!0),A(J,null,X(ne.value,(e,_)=>(M(),A("tr",{key:_},[t("td",ra,n(e.month),1),t("td",ua,n(i(e.highest)),1),t("td",_a,n(i(e.lowest)),1)]))),128))])])])])])]),_:1}),c(D,{value:"transactions"},{default:m(()=>[t("div",ma,[c(K,{class:"rounded-lg shadow-md"},{default:m(()=>[c(N,{class:"d-flex justify-between items-center px-6 py-4"},{default:m(()=>[fa,c(S,{onClick:d[2]||(d[2]=e=>w.value=!0),icon:"",variant:"text"},{default:m(()=>[pa]),_:1})]),_:1}),c(I,{class:"min-w-full text-sm pa-4"},{default:m(()=>[va,t("tbody",null,[(M(!0),A(J,null,X(ae.value,(e,_)=>(M(),A("tr",{key:_,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",ha,n(_+1),1),t("td",ya,n(u(e.date)),1),t("td",xa,n(e.description),1),t("td",{class:ue(["px-6 py-4 font-semibold",e.type==="CREDIT"?"text-green-600":"text-red-600"])},n(e.type),3),t("td",ba,n(i(e.amount)),1),t("td",ga,n(i(e.balance)),1)]))),128))])]),_:1}),c(z,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:m(()=>[wa,t("div",Ma,[Ta,c(U,{items:[15,30,45],modelValue:f.value,"onUpdate:modelValue":d[3]||(d[3]=e=>f.value=e),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),c(S,{icon:"",density:"comfortable"},{default:m(()=>[c(F,null,{default:m(()=>[y("mdi-chevron-left")]),_:1})]),_:1}),c(S,{icon:"",density:"comfortable"},{default:m(()=>[c(F,null,{default:m(()=>[y("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])]),c(E,{modelValue:w.value,"onUpdate:modelValue":d[16]||(d[16]=e=>w.value=e),location:"right",temporary:"",width:"500",class:"px-4 pt-6"},{default:m(()=>[t("div",Aa,[Oa,t("div",{icon:"",onClick:d[5]||(d[5]=e=>w.value=!1)},Ya)]),t("div",Sa,[t("div",null,[Ra,t("div",Ia,[c(et,{modelValue:dt.value,"onUpdate:modelValue":d[8]||(d[8]=e=>dt.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:m(({props:e})=>[c(V,_e({"model-value":it.value,label:"From",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16,["model-value"])]),default:m(()=>[c(tt,{modelValue:h.dateRange[0],"onUpdate:modelValue":[d[6]||(d[6]=e=>h.dateRange[0]=e),d[7]||(d[7]=e=>dt.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"]),c(et,{modelValue:q.value,"onUpdate:modelValue":d[11]||(d[11]=e=>q.value=e),"close-on-content-click":!1,transition:"scale-transition","offset-y":""},{activator:m(({props:e})=>[c(V,_e({"model-value":P.value,label:"To",readonly:""},e,{density:"compact",variant:"outlined","prepend-inner-icon":"mdi-calendar"}),null,16,["model-value"])]),default:m(()=>[c(tt,{modelValue:h.dateRange[1],"onUpdate:modelValue":[d[9]||(d[9]=e=>h.dateRange[1]=e),d[10]||(d[10]=e=>q.value=!1)]},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),t("div",null,[c(V,{color:"blue",label:"Description",modelValue:h.description,"onUpdate:modelValue":d[12]||(d[12]=e=>h.description=e),density:"compact",variant:"outlined",placeholder:"Enter description"},null,8,["modelValue"])]),t("div",null,[ja,c(U,{color:"blue",modelValue:h.type,"onUpdate:modelValue":d[13]||(d[13]=e=>h.type=e),items:["CREDIT","DEBIT"],density:"compact",variant:"outlined",placeholder:"Select type"},null,8,["modelValue"])]),t("div",Da,[c(V,{color:"blue",modelValue:h.minAmount,"onUpdate:modelValue":d[14]||(d[14]=e=>h.minAmount=e),label:"Min Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"]),c(V,{color:"blue",modelValue:h.maxAmount,"onUpdate:modelValue":d[15]||(d[15]=e=>h.maxAmount=e),label:"Max Amount",density:"compact",variant:"outlined",type:"number"},null,8,["modelValue"])]),t("div",Na,[c(S,{onClick:H,variant:"tonal",color:"primary"},{default:m(()=>[y("Apply")]),_:1}),c(S,{onClick:ct,variant:"text",color:"grey"},{default:m(()=>[y("Reset")]),_:1})])])]),_:1},8,["modelValue"])]))])]),_:1})}}},$a=Ne(Ea,[["__scopeId","data-v-7eb8fd72"]]);export{$a as default};
