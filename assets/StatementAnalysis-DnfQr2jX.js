import{b as lt,_ as Te,r as o,u as Ae,e as Oe,o as Ye,f as R,g as w,h as Se,w as m,M as ke,i as ft,j as T,k as t,l as A,m as h,n as x,t as s,F as Q,p as Z,q as se,s as Re,E as mt,v as Ie,x as je}from"./index-C44GveWQ.js";var oe={exports:{}};(function(P,F){(function(ct,l){l()})(lt,function(){function ct(i,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}function l(i,d,Y){var r=new XMLHttpRequest;r.open("GET",i),r.responseType="blob",r.onload=function(){E(r.response,d,Y)},r.onerror=function(){console.error("could not download file")},r.send()}function tt(i){var d=new XMLHttpRequest;d.open("HEAD",i,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function $(i){try{i.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),i.dispatchEvent(d)}}var b=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof lt=="object"&&lt.global===lt?lt:void 0,it=b.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),E=b.saveAs||(typeof window!="object"||window!==b?function(){}:"download"in HTMLAnchorElement.prototype&&!it?function(i,d,Y){var r=b.URL||b.webkitURL,g=document.createElement("a");d=d||i.name||"download",g.download=d,g.rel="noopener",typeof i=="string"?(g.href=i,g.origin===location.origin?$(g):tt(g.href)?l(i,d,Y):$(g,g.target="_blank")):(g.href=r.createObjectURL(i),setTimeout(function(){r.revokeObjectURL(g.href)},4e4),setTimeout(function(){$(g)},0))}:"msSaveOrOpenBlob"in navigator?function(i,d,Y){if(d=d||i.name||"download",typeof i!="string")navigator.msSaveOrOpenBlob(ct(i,Y),d);else if(tt(i))l(i,d,Y);else{var r=document.createElement("a");r.href=i,r.target="_blank",setTimeout(function(){$(r)})}}:function(i,d,Y,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof i=="string")return l(i,d,Y);var g=i.type==="application/octet-stream",dt=/constructor/i.test(b.HTMLElement)||b.safari,et=/CriOS\/[\d]+/.test(navigator.userAgent);if((et||g&&dt||it)&&typeof FileReader<"u"){var U=new FileReader;U.onloadend=function(){var C=U.result;C=et?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=C:location=C,r=null},U.readAsDataURL(i)}else{var V=b.URL||b.webkitURL,W=V.createObjectURL(i);r?r.location=W:location.href=W,r=null,setTimeout(function(){V.revokeObjectURL(W)},4e4)}});b.saveAs=E.saveAs=E,P.exports=E})})(oe);var De=oe.exports;const e=P=>(Ie("data-v-0bf7f45c"),P=P(),je(),P),Ne={class:"p-2 bg-[#f0f8ff]"},Le=e(()=>t("h2",{class:"text-xl font-bold mt-2 ml-6"},"Statement Analysis Result",-1)),Ee={key:0,class:"flex items-center justify-center h-96"},Be={key:1,class:"p-2 md:p-8"},$e={class:"flex justify-between"},Ce=e(()=>t("i",{class:"fas fa-arrow-left mr-2"},null,-1)),Ue={class:"text-right"},We=e(()=>t("i",{class:"fas fa-download mr-2"},null,-1)),qe={class:"grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-700 mt-4 mb-6"},He=e(()=>t("i",{class:"fas fa-calendar mr-2"},null,-1)),Pe=e(()=>t("strong",null,"Statement Period:",-1)),Ve=e(()=>t("br",null,null,-1)),Ge=e(()=>t("i",{class:"fas fa-user-circle mr-2"},null,-1)),ze=e(()=>t("strong",null,"Account Name:",-1)),Ke=e(()=>t("br",null,null,-1)),Je=e(()=>t("i",{class:"fas fa-id-card mr-2"},null,-1)),Xe=e(()=>t("strong",null,"Account Number:",-1)),Qe=e(()=>t("br",null,null,-1)),Ze={class:"mt-6"},Fe={class:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 px-4"},ts={class:"bg-blue-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},es={class:"text-md font-semibold"},ss=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Credit",-1)),os={class:"bg-red-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},ns={class:"text-md font-semibold"},as=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Total Debits",-1)),ls={class:"bg-green-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},cs={class:"text-md font-semibold"},is=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Credit",-1)),ds={class:"bg-purple-50 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},rs={class:"text-md font-semibold"},us=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Avg. Monthly Debits",-1)),_s={class:"bg-gray-100 text-center shadow rounded-2xl p-4 flex flex-col items-center justify-center"},fs={class:"text-md font-semibold"},hs=e(()=>t("div",{class:"text-sm text-gray-500 mt-1"},"Average Monthly Balance",-1)),ms={class:"flex flex-col md:flex-row gap-4 p-4"},ps={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},vs=e(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense",-1)),ys={class:"font-semibold text-gray-800 leading-tight"},xs=e(()=>t("br",null,null,-1)),bs={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},gs=e(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Highest Spend",-1)),ws={class:"font-semibold text-gray-800 text-lg"},Ms={class:"text-sm font-semibold text-gray-600 mt-1"},Ts={class:"bg-white rounded-2xl shadow-md p-4 w-full md:w-1/3"},As=e(()=>t("p",{class:"text-sm text-gray-500 mb-1"},"Most Frequent Expense Amount",-1)),Os={class:"font-semibold text-gray-800 text-lg"},Ys={class:"bg-white p-6 rounded-2xl shadow-md overflow-x-auto"},Ss=e(()=>t("h2",{class:"text-lg font-semibold text-gray-800 m-4"},"Expenses",-1)),ks={class:"min-w-full table-auto border-collapse"},Rs=e(()=>t("thead",null,[t("tr",{class:"text-left text-sm font-semibold text-gray-600 border-b border-gray-200"},[t("th",{class:"py-3 px-4"},"Expenses"),t("th",{class:"py-3 px-4"},"Average Monthly Expenditure"),t("th",{class:"py-3 px-4"},"Total Expenditure")])],-1)),Is={class:"py-3 px-4"},js={class:"py-3 px-4"},Ds={class:"py-3 px-4"},Ns={class:"flex flex-col md:flex-row gap-4 text-center text-gray-500 py-10"},Ls={class:"flex-1 bg-white border p-6 rounded-xl shadow"},Es=e(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Inflow Summary",-1)),Bs={class:"space-y-2"},$s={class:"flex justify-between"},Cs=e(()=>t("span",null,"Total Inflow",-1)),Us={class:"text-green-600 font-bold"},Ws={class:"flex justify-between"},qs=e(()=>t("span",null,"Average Monthly Inflow",-1)),Hs={class:"font-medium"},Ps={class:"flex justify-between"},Vs=e(()=>t("span",null,"Average Weekly Inflow",-1)),Gs={class:"font-medium"},zs={class:"flex-1 bg-white border p-6 rounded-xl shadow"},Ks=e(()=>t("h2",{class:"text-lg font-semibold text-blue-800 mb-4"},"Outflow Summary",-1)),Js={class:"space-y-2"},Xs={class:"flex justify-between"},Qs=e(()=>t("span",null,"Total Outflow",-1)),Zs={class:"text-red-600 font-bold"},Fs={class:"flex justify-between"},to=e(()=>t("span",null,"Average Monthly Outflow",-1)),eo={class:"font-medium"},so={class:"flex justify-between"},oo=e(()=>t("span",null,"Average Weekly Outflow",-1)),no={class:"font-medium"},ao={class:"flex gap-4 justify-between p-2"},lo={class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},co={class:"flex-1 text-md font-semibold"},io=e(()=>t("div",{class:"text-sm mt-2"},"Average Monthly Balance",-1)),ro={class:"flex-1 text- text-md font-semibold"},uo=e(()=>t("div",{class:"text-sm mt-2"},"Average Weekly Balance",-1)),_o=e(()=>t("div",{class:"flex justify-between bg-[#1f4e99] text-white rounded-2xl p-6 w-full"},[t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Inflow to Outflow Rate")]),t("div",{class:"flex-1"},[t("div",{class:"text-md font-semibold"},"Negative Cash Flow"),t("div",{class:"text-sm mt-2"},"Overall Inflow to Outflow")])],-1)),fo={class:"p-2 rounded-lg shadow-md"},ho=e(()=>t("h2",{class:"text-lg font-semibold text-gray-800 mb-2 mt-2"}," Credit & Debit Summary ",-1)),mo={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},po={class:"bg-white p-4 rounded-lg shadow"},vo=e(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Monthly Credit & Debit",-1)),yo={class:"overflow-y-auto max-h-96"},xo={class:"min-w-full table-auto text-sm text-left text-gray-600"},bo=e(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Month"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),go={class:"px-2 py-2"},wo={class:"px-2 py-2"},Mo={class:"px-2 py-2"},To={class:"bg-white p-4 rounded-lg shadow"},Ao=e(()=>t("h3",{class:"text-lg font-bold text-gray-700 mb-3"},"Weekly Credit & Debit",-1)),Oo={class:"overflow-y-auto max-h-96"},Yo={class:"min-w-full table-auto text-sm text-left text-gray-600"},So=e(()=>t("thead",{class:"bg-gray-100 font-medium text-gray-700"},[t("tr",null,[t("th",{class:"px-2 py-2"},"Week"),t("th",{class:"px-2 py-2"},"Total Credit"),t("th",{class:"px-2 py-2"},"Total Debit")])],-1)),ko={class:"px-2 py-2"},Ro={class:"px-2 py-2"},Io={class:"px-2 py-2"},jo={class:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm"},Do={class:"bg-white p-6 rounded-2xl shadow-md"},No=e(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Loan Analysis",-1)),Lo={class:"space-y-2"},Eo={class:"flex justify-between"},Bo=e(()=>t("span",null,"Number of Loan Transactions",-1)),$o={class:"flex justify-between"},Co=e(()=>t("span",null,"Total Loan Amount",-1)),Uo={class:"flex justify-between"},Wo=e(()=>t("span",null,"Average Monthly Loan Amount",-1)),qo={class:"flex justify-between"},Ho=e(()=>t("span",null,"Total Loan Repayment Amount",-1)),Po={class:"flex justify-between"},Vo=e(()=>t("span",null,"Average Monthly Loan Repayment Amount",-1)),Go={class:"flex justify-between"},zo=e(()=>t("span",null,"Loan to Inflow Rate",-1)),Ko={class:"flex justify-between"},Jo=e(()=>t("span",null,"Latest Loan Transaction Date",-1)),Xo={class:"flex justify-between"},Qo=e(()=>t("span",null,"Latest Loan Repayment Transaction Date",-1)),Zo={class:"bg-white p-6 rounded-2xl shadow-md"},Fo=e(()=>t("h2",{class:"text-lg font-semibold text-blue-700 mb-4"},"Patterns",-1)),tn={class:"space-y-2"},en={class:"flex justify-between"},sn=e(()=>t("span",null,"Account Sweep",-1)),on={class:"flex justify-between"},nn=e(()=>t("span",null,"Number of Betting Transactions",-1)),an={class:"flex justify-between"},ln=e(()=>t("span",null,"Gambling Rate",-1)),cn={class:"flex justify-between"},dn=e(()=>t("span",null,"Percentage of Debit Transactions",-1)),rn={class:"flex justify-between"},un=e(()=>t("span",null,"Percentage of Credit Transactions",-1)),_n={class:"flex justify-between"},fn=e(()=>t("span",null,"Percentage of Transactions between 500k - 1M",-1)),hn={class:"flex justify-between"},mn=e(()=>t("span",null,"Percentage of Transactions Greater Than 1M",-1)),pn={class:"flex justify-between"},vn=e(()=>t("span",null,"Most Frequent Balance Range",-1)),yn={class:"flex flex-wrap gap-4 justify-between mt-4"},xn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},bn={class:"grid grid-cols-3 gap-4 text-sm md:text-base"},gn=e(()=>t("div",null,null,-1)),wn=e(()=>t("div",{class:"text-center font-medium"},"Outflow",-1)),Mn=e(()=>t("div",{class:"text-center font-medium"},"Inflow",-1)),Tn=e(()=>t("div",{class:"text-left"},"Number of Self Transfers",-1)),An={class:"text-center font-semibold"},On={class:"text-center font-semibold"},Yn=e(()=>t("div",{class:"text-left"},"Value of Self Transfers",-1)),Sn={class:"text-center font-semibold"},kn={class:"text-center font-semibold"},Rn={class:"bg-[#2059a5] text-white p-6 rounded-2xl w-full md:w-[48%] shadow"},In={class:"grid grid-cols-2 gap-4 text-center"},jn={class:"text-2xl font-bold"},Dn=e(()=>t("div",{class:"text-sm"},"Total Transactions",-1)),Nn={class:"text-2xl font-bold"},Ln=e(()=>t("div",{class:"text-sm"},"Returned Cheque",-1)),En={class:"flex flex-col md:flex-row gap-6 justify-between mt-4"},Bn={class:"w-full md:w-1/2"},$n=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Self Transfer Transactions ",-1)),Cn={class:"bg-white rounded-xl border shadow p-4 max-h-96 overflow-y-auto"},Un={class:"w-full text-sm text-left"},Wn=e(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Inflow"),t("th",{class:"py-2 px-4"},"Outflow")])],-1)),qn={key:0},Hn=e(()=>t("td",{colspan:"3",class:"text-center py-4 text-gray-500"}," No data available ",-1)),Pn=[Hn],Vn={class:"py-2 px-4"},Gn={class:"py-2 px-4"},zn={class:"py-2 px-4"},Kn={class:"w-full md:w-1/2"},Jn=e(()=>t("h3",{class:"font-semibold text-sm md:text-base mb-2"}," Account Balance Analysis ",-1)),Xn={class:"bg-white border rounded-xl shadow p-4 max-h-96 overflow-y-auto"},Qn={class:"w-full text-sm text-left"},Zn=e(()=>t("thead",{class:"text-gray-600"},[t("tr",null,[t("th",{class:"py-2 px-4"},"Month"),t("th",{class:"py-2 px-4"},"Highest Balance"),t("th",{class:"py-2 px-4"},"Lowest Balance")])],-1)),Fn={class:"py-2 px-4"},ta={class:"py-2 px-4"},ea={class:"py-2 px-4"},sa={class:"py-4"},oa=e(()=>t("thead",{class:"font-semibold text-gray-600"},[t("tr",null,[t("th",{class:"px-2 py-3 font-medium"},"S/N"),t("th",{class:"px-2 py-3 font-medium"},"Date"),t("th",{class:"px-2 py-3 font-medium"},"Description"),t("th",{class:"px-2 py-3 font-medium"},"Type"),t("th",{class:"px-2 py-3 font-medium"},"Amount"),t("th",{class:"px-2 py-3 font-medium"},"Balance")])],-1)),na={class:"px-2 py-4"},aa={class:"px-2 py-4"},la={class:"px-2 py-4"},ca={class:"px-2 py-4"},ia={class:"px-2 py-4"},da=e(()=>t("span",null,"1â€“12 of 12",-1)),ra={class:"flex items-center space-x-2"},ua=e(()=>t("span",null,"Rows per page:",-1)),_a={__name:"StatementAnalysis",setup(P){const F=o("Summary"),ct=_=>T(_).format("MMMM Do YYYY,");function l(_){return new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN",minimumFractionDigits:2}).format(_||0)}const tt=o(15),$=Ae(),b=Oe(),it=o(null),E=o(!0),i=o(null),d=o(""),Y=o(""),r=o(""),g=o(""),dt=o(0),et=o(0),U=o(0),V=o(0),W=o(0),C=o(0),pt=o(0),ne=o(0),vt=o(0),yt=o(0),ae=o(0),xt=o(0),bt=o([]),gt=o([]),wt=o(0),Mt=o(0),Tt=o(0),At=o(""),Ot=o([]),Yt=o(""),St=o(""),kt=o(""),Rt=o(""),It=o(0),ht=o(""),jt=o(0),Dt=o(""),le=o(0),ce=o(0),Nt=o(0),Lt=o(0),Et=o(0),Bt=o(0),$t=o(0),ie=o(0),de=o(0),Ct=o(""),Ut=o([]),Wt=o(""),re=o(""),ue=o(0),_e=o(""),qt=o(0),Ht=o(0),Pt=o(0),Vt=o(0),Gt=o(0),zt=o(0),Kt=o(0),rt=o([]),Jt=o([]),Xt=o([]),fe=async _=>{var S,I,N,L,j,z,K,J,X,ut,c,M,Qt;const p=JSON.parse(localStorage.getItem("data")||"{}"),q=(p==null?void 0:p.token)||b.token,B=`https://dev02201.getjupita.com/api/${((S=p==null?void 0:p.user)==null?void 0:S.tenant_id)||b.tenant_id}/get-analysis-result?analysis_id=${_}`;E.value=!0;try{let Ft=function(a){return T(a,"M-YYYY").format("MMM YYYY")};const H=await ft.get(B,{headers:{Authorization:`Bearer ${q}`,"Content-Type":"application/json"}});console.log("statement analysis result page data:",H),it.value=H.data;const u=(L=(N=(I=H.data)==null?void 0:I.data)==null?void 0:N.analysis_result)==null?void 0:L.analysis_result;d.value=(u==null?void 0:u.name)||"N/A",Y.value=(u==null?void 0:u.clientFullName)||"N/A",g.value=(u==null?void 0:u.accountId)||"N/A";const v=(u==null?void 0:u.behavioralAnalysis)||{};ht.value=v.accountSweep||"No",jt.value=v.gamblingRate||0,Dt.value=v.gamblingStatus||"N/A",le.value=v.loanInflowRate||0,ce.value=v.accountActivity||0,Nt.value=v.totalLoanAmount||0,Lt.value=v.loanToInflowRate||0,Et.value=v.numberLoanTransactions||0,Bt.value=v.averageMonthlyLoanAmount||0,$t.value=v.totalLoanRepaymentAmount||0,ie.value=v.loanRepaymentToInflowRate||0,de.value=v.numberRepaymentTransactions||0,Ut.value=v.latestRepaymentTransaction||[];const _t=Ut.value[0]||null;Wt.value=_t!=null&&_t.date?T(_t.date).format("MMM D, YYYY"):"N/A";const Zt=(j=v.latestLoanTransaction)==null?void 0:j[0];Ct.value=Zt?T(Zt.date).format("MMMM D, YYYY"):"N/A",re.value=v.overallInflowToOutflowRate||"N/A",ue.value=v.percentOfInflowIrregularity||0,_e.value=v.monthToMonthInflowToOutflowRate||"N/A",qt.value=v.averageMonthlyLoanRepaymentAmount||0;const n=u==null?void 0:u.cashFlowAnalysis;console.log("cash flow data:",n),wt.value=u==null?void 0:u.spendAnalysis.mostFrequentExpense,Mt.value=u==null?void 0:u.spendAnalysis.mostFrequentExpenseAmount;const y=((X=(J=(K=(z=H.data)==null?void 0:z.data)==null?void 0:K.analysis_result)==null?void 0:J.analysis_result)==null?void 0:X.spendAnalysis)||{},O=((Qt=(M=(c=(ut=H.data)==null?void 0:ut.data)==null?void 0:c.analysis_result)==null?void 0:M.analysis_result)==null?void 0:Qt.transactionPatternAnalysis)||{};console.log("pattern analysis:",O),Yt.value=(O.percentDebitTransactions*100).toFixed(2)+"%",St.value=(O.percentDebitTransactions*100).toFixed(2)+"%",kt.value=(O.percentOfTransactionsBetween500ThousandToOneMillionNaira*100).toFixed(2)+"%",Rt.value=(O.percentOfTransactionsGreaterThanOneMillionNaira*100).toFixed(2)+"%",It.value=O.mostFrequentBalanceRange,Ht.value=O.noOfSelfTransferInflows,Pt.value=O.noOfSelfTransferOutflows,Vt.value=O.selfTransferInflowAmount,Gt.value=O.selfTransferOutflowAmount,zt.value=O.totalNumberOfTransactions,Kt.value=O.returnCheque;const pe=O.selfTransferInflowTransactionsByMonth||[],ve=O.selfTransferOutflowTransactionsByMonth||[],st=new Map;pe.forEach(a=>{const f=Ft(a.date);st.set(f,{month:f,inflow:a.amount,outflow:0})}),ve.forEach(a=>{const f=Ft(a.date);st.has(f)?st.get(f).outflow=a.amount:st.set(f,{month:f,inflow:0,outflow:a.amount})}),rt.value=Array.from(st.values()).sort((a,f)=>T(a.month,"MMM YYYY")-T(f.month,"MMM YYYY")),Tt.value=y.highestSpend,At.value=T(y.monthWithHighestSpend,"M/YYYY").format("MMMM YYYY"),Ot.value=[{label:"Others",monthly:y.averageMonthlySpendOnOthers??0,total:12*(y.averageMonthlySpendOnOthers??0)},{label:"Rent",monthly:y.averageMonthlySpendOnRent??0,total:12*(y.averageMonthlySpendOnRent??0)},{label:"Hospitality and Food",monthly:y.averageMonthlySpendOnHospitalityAndFood??0,total:12*(y.averageMonthlySpendOnHospitalityAndFood??0)},{label:"Transportation",monthly:y.averageMonthlySpendOnTransportation??0,total:12*(y.averageMonthlySpendOnTransportation??0)},{label:"Utilities",monthly:y.averageMonthlySpendOnUtilities??0,total:12*(y.averageMonthlySpendOnUtilities??0)},{label:"Charges and Stamp Duty",monthly:y.averageMonthlySpendOnChargesAndStampDuty??0,total:12*(y.averageMonthlySpendOnChargesAndStampDuty??0)},{label:"Transfer",monthly:y.averageMonthlySpendOnTransfer??0,total:12*(y.averageMonthlySpendOnTransfer??0)},{label:"ATM Withdrawals and POS",monthly:y.averageMonthlySpendOnAtmAndPOS??0,total:12*(y.averageMonthlySpendOnAtmAndPOS??0)}],dt.value=(n==null?void 0:n.totalDebitTurnOver)||0,et.value=(n==null?void 0:n.totalCreditTurnover)||0,U.value=(n==null?void 0:n.averageMonthlyDebits)||0,V.value=(n==null?void 0:n.averageMonthlyCredits)||0,W.value=(n==null?void 0:n.averageMonthlyBalance)||0,C.value=(n==null?void 0:n.averageWeeklyBalance)||0,pt.value=(n==null?void 0:n.totalCreditTurnover)||0,ne.value=(n==null?void 0:n.averageMonthlyCredits)||0,vt.value=(n==null?void 0:n.averageWeeklyCredits)||0,yt.value=(n==null?void 0:n.totalDebitTurnOver)||0,ae.value=(n==null?void 0:n.averageMonthlyDebits)||0,xt.value=(n==null?void 0:n.averageWeeklyDebits)||0;const ye=(n==null?void 0:n.monthlyHighestBalance)||[],xe=(n==null?void 0:n.monthlyLowestBalance)||[],ot=new Map;ye.forEach(a=>{const f=`${a.month_name} ${a.year}`,k=T(f,"MMMM YYYY").format("MMM YYYY"),D=`${a.month_name}-${a.year}`;ot.set(D,{month:k,highest:a.highest_balance,lowest:0})}),xe.forEach(a=>{const f=`${a.month_name} ${a.year}`,k=T(f,"MMMM YYYY").format("MMM YYYY"),D=`${a.month_name}-${a.year}`;ot.has(D)?ot.get(D).lowest=a.lowest_balance:ot.set(D,{month:k,highest:0,lowest:a.lowest_balance})}),Jt.value=Array.from(ot.values());const be=(n==null?void 0:n.monthlyInflow)||[],ge=(n==null?void 0:n.monthlyOutflow)||[],nt=new Map;be.forEach(a=>{const f=`${a.month_name} ${a.year}`,k=T(f,"MMMM YYYY").format("MMM YYYY"),D=`${a.month_name}-${a.year}`;nt.set(D,{month:k,credit:a.amount,debit:0})}),ge.forEach(a=>{const f=`${a.month_name} ${a.year}`,k=T(f,"MMMM YYYY").format("MMM YYYY"),D=`${a.month_name}-${a.year}`;nt.has(D)?nt.get(D).debit=a.amount:nt.set(D,{month:k,credit:0,debit:a.amount})}),bt.value=Array.from(nt.values());const we=(n==null?void 0:n.weeklyInflow)||[],Me=(n==null?void 0:n.weeklyOutflow)||[],at=new Map;we.forEach(a=>{const f=T().month(a.month_name).format("MMM"),k=`${a.year}-${f}-W${a.week}`;at.set(k,{week:`${f} ${a.year} | ${a.week}`,credit:a.amount,debit:0})}),Me.forEach(a=>{const f=T().month(a.month_name).format("MMM"),k=`${a.year}-${f}-W${a.week}`;at.has(k)?at.get(k).debit=a.amount:at.set(k,{week:`${f} ${a.year} ${a.week}`,credit:0,debit:a.amount})}),gt.value=Array.from(at.values());const te=new Date(u==null?void 0:u.startDate),ee=new Date(u==null?void 0:u.endDate);!isNaN(te)&&!isNaN(ee)?r.value=`${T(te).format("MMMM D, YYYY")} - ${T(ee).format("MMMM D, YYYY")}`:r.value="Unknown period"}catch(H){console.error("Error fetching analysis result:",H),i.value="Unable to fetch analysis result."}finally{E.value=!1}},he=async()=>{var S;const _=JSON.parse(localStorage.getItem("data")||"{}"),p=(_==null?void 0:_.token)||b.token,q=((S=_==null?void 0:_.user)==null?void 0:S.tenant_id)||b.tenant_id,G=$.params.id,B=`https://dev02201.getjupita.com/api/${q}/get-statement-transactions?analysis_id=${G}`;try{const I=await ft.get(B,{headers:{Authorization:`Bearer ${p}`}});console.log("fetch transactions response:",I),Xt.value=I.data.data.transactions}catch(I){console.error(I)}};Ye(()=>{he();const _=$.params.id;_?fe(_):(i.value="Invalid analysis ID.",E.value=!1)});const me=async()=>{var S,I,N;const _=JSON.parse(localStorage.getItem("data")||"{}"),p=(_==null?void 0:_.token)||b.token,q=((S=_==null?void 0:_.user)==null?void 0:S.tenant_id)||b.tenant_id,G=$.params.id,B=`https://dev02201.getjupita.com/api/${q}/download-insight-report?analysis_id=${G}`;try{mt({title:"Downloading",message:"Getting your analysis report...",type:"info",duration:3e3});const L=await ft.get(B,{headers:{Authorization:`Bearer ${p}`}}),j=(N=(I=L==null?void 0:L.data)==null?void 0:I.data)==null?void 0:N.download;if(!(j!=null&&j.document_url)||!(j!=null&&j.document_name))throw new Error("No download information or document URL found in the response.");const z=j.document_url,J="analysis_report.pdf",X=await ft.get(z,{responseType:"blob"});De.saveAs(X.data,J),mt({title:"Success",message:"Analysis report downloaded successfully.",type:"success",duration:6e3})}catch(L){console.error("Download failed:",L),mt({title:"Error",message:"Failed to download analysis. Please try again.",type:"error",duration:6e3})}};return(_,p)=>{const q=R("v-progress-circular"),G=R("RouterLink"),B=R("v-btn"),S=R("v-tab"),I=R("v-tabs"),N=R("v-tabs-window-item"),L=R("v-card-title"),j=R("v-table"),z=R("v-select"),K=R("v-icon"),J=R("v-card-actions"),X=R("v-card"),ut=R("v-tabs-window");return w(),Se(ke,null,{default:m(()=>[t("div",Ne,[Le,E.value?(w(),A("div",Ee,[h(q,{size:100,width:10,color:"primary",indeterminate:""})])):(w(),A("div",Be,[t("div",$e,[h(G,{to:"/dashboard"},{default:m(()=>[t("button",{onClick:p[0]||(p[0]=(...c)=>_.goBack&&_.goBack(...c)),class:"mb-2 flex items-center text-blue-600 font-semibold"},[Ce,x(" Back ")])]),_:1}),t("div",Ue,[h(B,{onClick:me,"no-uppercase":"",size:"small",class:"normal-case p-4 bg-blue-600 hover:bg-blue-700 text-white text-none mr-2 custom-btn"},{default:m(()=>[We,x(" Download Analysis ")]),_:1})])]),t("div",qe,[t("p",null,[He,Pe,x(),Ve,x(" "+s(r.value),1)]),t("p",null,[Ge,ze,x(),Ke,x(" "+s(Y.value),1)]),t("p",null,[Je,Xe,x(),Qe,x(" "+s(g.value),1)])]),t("div",Ze,[h(I,{"align-tabs":"center",class:"mb-6",modelValue:F.value,"onUpdate:modelValue":p[1]||(p[1]=c=>F.value=c),color:"primary"},{default:m(()=>[h(S,{value:"summary"},{default:m(()=>[x("Summary")]),_:1}),h(S,{value:"cash flow"},{default:m(()=>[x("Cash Flow")]),_:1}),h(S,{value:"behavioral"},{default:m(()=>[x("Behavioral")]),_:1}),h(S,{value:"transactions"},{default:m(()=>[x("Transactions")]),_:1})]),_:1},8,["modelValue"]),h(ut,{modelValue:F.value,"onUpdate:modelValue":p[3]||(p[3]=c=>F.value=c)},{default:m(()=>[h(N,{value:"summary"},{default:m(()=>[t("div",Fe,[t("div",ts,[t("div",es,s(l(et.value)),1),ss]),t("div",os,[t("div",ns,s(l(dt.value)),1),as]),t("div",ls,[t("div",cs,s(l(V.value)),1),is]),t("div",ds,[t("div",rs,s(l(U.value)),1),us]),t("div",_s,[t("div",fs,s(l(W.value)),1),hs])]),t("div",ms,[t("div",ps,[vs,t("p",ys,[x(s(wt.value),1),xs])]),t("div",bs,[gs,t("p",ws,s(l(Tt.value)),1),t("p",Ms," Transaction Date: "+s(At.value),1)]),t("div",Ts,[As,t("p",Os,s(l(Mt.value)),1)])]),t("div",Ys,[Ss,t("table",ks,[Rs,t("tbody",null,[(w(!0),A(Q,null,Z(Ot.value,(c,M)=>(w(),A("tr",{key:M,class:"text-sm text-gray-700 border-b border-gray-100 hover:bg-gray-50"},[t("td",Is,s(c.label),1),t("td",js,s(l(c.monthly)),1),t("td",Ds,s(l(c.total)),1)]))),128))])])])]),_:1}),h(N,{value:"cash flow"},{default:m(()=>[t("div",Ns,[t("div",Ls,[Es,t("div",Bs,[t("div",$s,[Cs,t("span",Us,s(l(pt.value)),1)]),t("div",Ws,[qs,t("span",Hs,s(l(V.value)),1)]),t("div",Ps,[Vs,t("span",Gs,s(l(vt.value)),1)])])]),t("div",zs,[Ks,t("div",Js,[t("div",Xs,[Qs,t("span",Zs,s(l(yt.value)),1)]),t("div",Fs,[to,t("span",eo,s(l(U.value)),1)]),t("div",so,[oo,t("span",no,s(l(xt.value)),1)])])])]),t("div",ao,[t("div",lo,[t("div",co,[x(s(l(W.value))+" ",1),io]),t("div",ro,[x(s(l(C.value))+" ",1),uo])]),_o]),t("div",fo,[ho,t("div",mo,[t("div",po,[vo,t("div",yo,[t("table",xo,[bo,t("tbody",null,[(w(!0),A(Q,null,Z(bt.value,(c,M)=>(w(),A("tr",{key:M,class:"border-b"},[t("td",go,s(c.month),1),t("td",wo,s(l(c.credit)),1),t("td",Mo,s(l(c.debit)),1)]))),128))])])])]),t("div",To,[Ao,t("div",Oo,[t("table",Yo,[So,t("tbody",null,[(w(!0),A(Q,null,Z(gt.value,(c,M)=>(w(),A("tr",{key:M,class:"border-b"},[t("td",ko,s(c.week),1),t("td",Ro,s(l(c.credit)),1),t("td",Io,s(l(c.debit)),1)]))),128))])])])])])])]),_:1}),h(N,{value:"behavioral"},{default:m(()=>[t("div",jo,[t("div",Do,[No,t("div",Lo,[t("div",Eo,[Bo,t("span",null,s(Et.value),1)]),t("div",$o,[Co,t("span",null,s(l(Nt.value)),1)]),t("div",Uo,[Wo,t("span",null,s(l(Bt.value)),1)]),t("div",qo,[Ho,t("span",null,s(l($t.value)),1)]),t("div",Po,[Vo,t("span",null,s(l(qt.value)),1)]),t("div",Go,[zo,t("span",null,s(Lt.value)+"%",1)]),t("div",Ko,[Jo,t("span",null,s(Ct.value),1)]),t("div",Xo,[Qo,t("span",null,s(Wt.value),1)])])]),t("div",Zo,[Fo,t("div",tn,[t("div",en,[sn,t("span",{class:se(["font-semibold",ht.value==="YES"?"text-green-600":"text-gray-600"])},s(ht.value),3)]),t("div",on,[nn,t("span",null,s(Dt.value),1)]),t("div",an,[ln,t("span",null,s(jt.value),1)]),t("div",cn,[dn,t("span",null,s(Yt.value),1)]),t("div",rn,[un,t("span",null,s(St.value),1)]),t("div",_n,[fn,t("span",null,s(kt.value),1)]),t("div",hn,[mn,t("span",null,s(Rt.value),1)]),t("div",pn,[vn,t("span",null,s(It.value),1)])])])]),t("div",yn,[t("div",xn,[t("div",bn,[gn,wn,Mn,Tn,t("div",An,s(Pt.value),1),t("div",On,s(Ht.value),1),Yn,t("div",Sn,s(l(Gt.value)),1),t("div",kn,s(l(Vt.value)),1)])]),t("div",Rn,[t("div",In,[t("div",null,[t("div",jn,s(zt.value),1),Dn]),t("div",null,[t("div",Nn,s(Kt.value),1),Ln])])])]),t("div",En,[t("div",Bn,[$n,t("div",Cn,[t("table",Un,[Wn,t("tbody",null,[!rt.value||rt.value.length===0?(w(),A("tr",qn,Pn)):Re("",!0),(w(!0),A(Q,null,Z(rt.value,(c,M)=>(w(),A("tr",{key:M,class:"border-b last:border-none"},[t("td",Vn,s(c.month),1),t("td",Gn,s(l(c.inflow)),1),t("td",zn,s(l(c.outflow)),1)]))),128))])])])]),t("div",Kn,[Jn,t("div",Xn,[t("table",Qn,[Zn,t("tbody",null,[(w(!0),A(Q,null,Z(Jt.value,(c,M)=>(w(),A("tr",{key:M},[t("td",Fn,s(c.month),1),t("td",ta,s(l(c.highest)),1),t("td",ea,s(l(c.lowest)),1)]))),128))])])])])])]),_:1}),h(N,{value:"transactions"},{default:m(()=>[t("div",sa,[h(X,{class:"rounded-lg shadow-md"},{default:m(()=>[h(L,{class:"text-2xl font-semibold px-6 py-4"},{default:m(()=>[x("Transaction History")]),_:1}),h(j,{class:"min-w-full text-sm pa-4"},{default:m(()=>[oa,t("tbody",null,[(w(!0),A(Q,null,Z(Xt.value,(c,M)=>(w(),A("tr",{key:M,class:"border-t border-gray-200 hover:bg-gray-50 transition-colors"},[t("td",na,s(M+1),1),t("td",aa,s(ct(c.date)),1),t("td",la,s(c.description),1),t("td",{class:se(["px-6 py-4 font-semibold",c.type==="CREDIT"?"text-green-600":"text-red-600"])},s(c.type),3),t("td",ca,s(l(c.amount)),1),t("td",ia,s(l(c.balance)),1)]))),128))])]),_:1}),h(J,{class:"justify-between px-6 py-4 text-sm text-gray-500"},{default:m(()=>[da,t("div",ra,[ua,h(z,{items:[15,30,45],modelValue:tt.value,"onUpdate:modelValue":p[2]||(p[2]=c=>tt.value=c),density:"compact","hide-details":"",class:"w-20",variant:"outlined"},null,8,["modelValue"]),h(B,{icon:"",density:"comfortable"},{default:m(()=>[h(K,null,{default:m(()=>[x("mdi-chevron-left")]),_:1})]),_:1}),h(B,{icon:"",density:"comfortable"},{default:m(()=>[h(K,null,{default:m(()=>[x("mdi-chevron-right")]),_:1})]),_:1})])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue"])])]))])]),_:1})}}},ha=Te(_a,[["__scopeId","data-v-0bf7f45c"]]);export{ha as default};
